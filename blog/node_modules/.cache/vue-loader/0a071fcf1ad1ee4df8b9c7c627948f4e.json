{"remainingRequest":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\src\\components\\Reply.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\src\\components\\Reply.vue","mtime":1723305235328},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBFbW9qaSBmcm9tICIuL0Vtb2ppIjsKaW1wb3J0IEVtb2ppTGlzdCBmcm9tICIuLi9hc3NldHMvanMvZW1vamkiOwpleHBvcnQgZGVmYXVsdCB7CiAgY29tcG9uZW50czogewogICAgRW1vamkKICB9LAogIHByb3BzOiB7CiAgICB0eXBlOiB7CiAgICAgIHR5cGU6IE51bWJlcgogICAgfQogIH0sCiAgZGF0YTogZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gewogICAgICBpbmRleDogMCwKICAgICAgY2hvb3NlRW1vamk6IGZhbHNlLAogICAgICBuaWNrbmFtZTogIiIsCiAgICAgIHJlcGx5VXNlcklkOiBudWxsLAogICAgICBwYXJlbnRJZDogbnVsbCwKICAgICAgY29tbWVudENvbnRlbnQ6ICIiCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgY2FuY2xlUmVwbHkoKSB7CiAgICAgIHRoaXMuJHJlZnMucmVwbHkuc3R5bGUuZGlzcGxheSA9ICJub25lIjsKICAgIH0sCiAgICBpbnNlcnRSZXBseSgpIHsKICAgICAgaWYgKCF0aGlzLiRzdG9yZS5zdGF0ZS51c2VySWQpIHsKICAgICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5sb2dpbkZsYWcgPSB0cnVlOwogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQoKICAgICAgaWYgKHRoaXMuY29tbWVudENvbnRlbnQudHJpbSgpID09PSAiIikgewogICAgICAgIHRoaXMuJHRvYXN0KHsgdHlwZTogImVycm9yIiwgbWVzc2FnZTogIuWbnuWkjeS4jeiDveS4uuepuiIgfSk7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CgogICAgICBjb25zdCByZWcgPSAvXFsuKz9cXS9nOwogICAgICB0aGlzLmNvbW1lbnRDb250ZW50ID0gdGhpcy5jb21tZW50Q29udGVudC5yZXBsYWNlKHJlZywgKHN0cikgPT4gewogICAgICAgIHJldHVybiAoCiAgICAgICAgICAgICI8aW1nIHNyYz0nIiArCiAgICAgICAgICAgIEVtb2ppTGlzdFtzdHJdICsKICAgICAgICAgICAgIicgd2lkdGg9JzI0JyBoZWlnaHQ9JzI0JyBzdHlsZT0nbWFyZ2luOiAwIDFweDsgdmVydGljYWwtYWxpZ246IHRleHQtYm90dG9tJy8+IgogICAgICAgICk7CiAgICAgIH0pOwoKICAgICAgY29uc3QgcGF0aCA9IHRoaXMuJHJvdXRlLnBhdGg7CiAgICAgIGNvbnN0IGFyciA9IHBhdGguc3BsaXQoIi8iKTsKICAgICAgY29uc3QgY29tbWVudCA9IHsKICAgICAgICB0eXBlOiB0aGlzLnR5cGUsCiAgICAgICAgcmVwbHlVc2VySWQ6IHRoaXMucmVwbHlVc2VySWQsCiAgICAgICAgcGFyZW50SWQ6IHRoaXMucGFyZW50SWQsCiAgICAgICAgY29tbWVudENvbnRlbnQ6IHRoaXMuY29tbWVudENvbnRlbnQKICAgICAgfTsKCiAgICAgIGlmICh0aGlzLnR5cGUgPT09IDEgfHwgdGhpcy50eXBlID09PSAzKSB7CiAgICAgICAgY29tbWVudC50b3BpY0lkID0gYXJyWzJdOwogICAgICB9CgogICAgICB0aGlzLmNvbW1lbnRDb250ZW50ID0gIiI7CiAgICAgIGNvbnN0IHRva2VuID0gdGhpcy4kc3RvcmUuc3RhdGUudG9rZW4gfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyk7CgogICAgICB0aGlzLmF4aW9zLnBvc3QoIi9hcGkvY29tbWVudHMiLCBjb21tZW50LCB7CiAgICAgICAgaGVhZGVyczogewogICAgICAgICAgJ0F1dGhvcml6YXRpb24nOiBgQmVhcmVyICR7dG9rZW59YAogICAgICAgIH0KICAgICAgfSkudGhlbigoeyBkYXRhIH0pID0+IHsKICAgICAgICBjb25zb2xlLmxvZygiUmVzcG9uc2UgZnJvbSBzZXJ2ZXI6IiwgZGF0YSk7IC8vIERlYnVnIGxvZwoKICAgICAgICBpZiAoZGF0YS5kYXRhICYmIGRhdGEuZGF0YS5yZWNvcmRMaXN0ICYmIGRhdGEuZGF0YS5yZWNvcmRMaXN0Lmxlbmd0aCkgewogICAgICAgICAgLy8g5aaC5p6c5pWw5o2u5qC85byP5q2j56Gu77yM5omn6KGMIFVJIOabtOaWsAogICAgICAgICAgdGhpcy4kZW1pdCgicmVsb2FkUmVwbHkiLCB0aGlzLmluZGV4KTsKICAgICAgICAgIHRoaXMuJHRvYXN0KHsgdHlwZTogInN1Y2Nlc3MiLCBtZXNzYWdlOiAi5Zue5aSN5oiQ5YqfIiB9KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhpcy4kdG9hc3QoeyB0eXBlOiAiZXJyb3IiLCBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UgfHwgIuWbnuWkjeaPkOS6pOWksei0pSIgfSk7CiAgICAgICAgfQogICAgICB9KS5jYXRjaChlcnJvciA9PiB7CiAgICAgICAgY29uc29sZS5lcnJvcigiRXJyb3Igc3VibWl0dGluZyByZXBseToiLCBlcnJvcik7IC8vIERlYnVnIGxvZwogICAgICAgIHRoaXMuJHRvYXN0KHsgdHlwZTogImVycm9yIiwgbWVzc2FnZTogIuWbnuWkjeaPkOS6pOWksei0pe+8jOivt+eojeWQjuWGjeivlSIgfSk7CiAgICAgIH0pOwogICAgfQoKICAgICwKICAgIGFkZEVtb2ppKHRleHQpIHsKICAgICAgdGhpcy5jb21tZW50Q29udGVudCArPSB0ZXh0OwogICAgfQogIH0KfTsK"},{"version":3,"sources":["Reply.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA+BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"Reply.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <div class=\"reply-input-wrapper\" style=\"display: none\" ref=\"reply\">\n    <textarea\n      class=\"comment-textarea\"\n      :placeholder=\"'回复 @' + nickname + '：'\"\n      auto-grow\n      dense\n      v-model=\"commentContent\"\n    />\n    <div class=\"emoji-container\">\n      <span\n        :class=\"chooseEmoji ? 'emoji-btn-active' : 'emoji-btn'\"\n        @click=\"chooseEmoji = !chooseEmoji\"\n      >\n        <i class=\"iconfont iconbiaoqing\" />\n      </span>\n      <div style=\"margin-left:auto\">\n        <button @click=\"cancleReply\" class=\"cancle-btn v-comment-btn\">\n          取消\n        </button>\n        <button @click=\"insertReply\" class=\"upload-btn v-comment-btn\">\n          提交\n        </button>\n      </div>\n    </div>\n    <!-- 表情框 -->\n    <emoji @addEmoji=\"addEmoji\" :chooseEmoji=\"chooseEmoji\" />\n  </div>\n</template>\n\n<script>\nimport Emoji from \"./Emoji\";\nimport EmojiList from \"../assets/js/emoji\";\nexport default {\n  components: {\n    Emoji\n  },\n  props: {\n    type: {\n      type: Number\n    }\n  },\n  data: function() {\n    return {\n      index: 0,\n      chooseEmoji: false,\n      nickname: \"\",\n      replyUserId: null,\n      parentId: null,\n      commentContent: \"\"\n    };\n  },\n  methods: {\n    cancleReply() {\n      this.$refs.reply.style.display = \"none\";\n    },\n    insertReply() {\n      if (!this.$store.state.userId) {\n        this.$store.state.loginFlag = true;\n        return false;\n      }\n\n      if (this.commentContent.trim() === \"\") {\n        this.$toast({ type: \"error\", message: \"回复不能为空\" });\n        return false;\n      }\n\n      const reg = /\\[.+?\\]/g;\n      this.commentContent = this.commentContent.replace(reg, (str) => {\n        return (\n            \"<img src='\" +\n            EmojiList[str] +\n            \"' width='24' height='24' style='margin: 0 1px; vertical-align: text-bottom'/>\"\n        );\n      });\n\n      const path = this.$route.path;\n      const arr = path.split(\"/\");\n      const comment = {\n        type: this.type,\n        replyUserId: this.replyUserId,\n        parentId: this.parentId,\n        commentContent: this.commentContent\n      };\n\n      if (this.type === 1 || this.type === 3) {\n        comment.topicId = arr[2];\n      }\n\n      this.commentContent = \"\";\n      const token = this.$store.state.token || localStorage.getItem('token');\n\n      this.axios.post(\"/api/comments\", comment, {\n        headers: {\n          'Authorization': `Bearer ${token}`\n        }\n      }).then(({ data }) => {\n        console.log(\"Response from server:\", data); // Debug log\n\n        if (data.data && data.data.recordList && data.data.recordList.length) {\n          // 如果数据格式正确，执行 UI 更新\n          this.$emit(\"reloadReply\", this.index);\n          this.$toast({ type: \"success\", message: \"回复成功\" });\n        } else {\n          this.$toast({ type: \"error\", message: data.message || \"回复提交失败\" });\n        }\n      }).catch(error => {\n        console.error(\"Error submitting reply:\", error); // Debug log\n        this.$toast({ type: \"error\", message: \"回复提交失败，请稍后再试\" });\n      });\n    }\n\n    ,\n    addEmoji(text) {\n      this.commentContent += text;\n    }\n  }\n};\n</script>\n\n<style scoped>\n.reply-input-wrapper {\n  border: 1px solid #90939950;\n  border-radius: 4px;\n  padding: 10px;\n  margin: 0 0 10px;\n}\n</style>\n"]}]}