{"remainingRequest":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\vue-image-crop-upload\\upload-3.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\vue-image-crop-upload\\upload-3.vue","mtime":1723726513108},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCid1c2Ugc3RyaWN0JzsKaW1wb3J0IGxhbmd1YWdlIGZyb20gJy4vdXRpbHMvbGFuZ3VhZ2UuanMnOwppbXBvcnQgbWltZXMgZnJvbSAnLi91dGlscy9taW1lcy5qcyc7CmltcG9ydCBkYXRhMmJsb2IgZnJvbSAnLi91dGlscy9kYXRhMmJsb2IuanMnOwppbXBvcnQgZWZmZWN0UmlwcGxlIGZyb20gJy4vdXRpbHMvZWZmZWN0UmlwcGxlLmpzJzsKCmV4cG9ydCBkZWZhdWx0IHsKCXByb3BzOiB7CgkJLy8g5Z+f77yM5LiK5Lyg5paH5Lu2bmFtZe+8jOinpuWPkeS6i+S7tuS8muW4puS4iu+8iOWmguaenOS4gOS4qumhtemdouWkmuS4quWbvueJh+S4iuS8oOaOp+S7tu+8jOWPr+S7peWBmuWMuuWIhgoJCWZpZWxkOiB7CgkJCXR5cGU6IFN0cmluZywKCQkJJ2RlZmF1bHQnOiAnYXZhdGFyJwoJCX0sCgkJLy8g5Y6f5ZCNa2V577yM57G75Ly85LqOaWTvvIzop6blj5Hkuovku7bkvJrluKbkuIrvvIjlpoLmnpzkuIDkuKrpobXpnaLlpJrkuKrlm77niYfkuIrkvKDmjqfku7bvvIzlj6/ku6XlgZrljLrliIYKCQlraTogewoJCQl0eXBlOiBTdHJpbmcsCgkJCSdkZWZhdWx0JzogJzAnCgkJfSwKCQkvLyDmmL7npLror6Xmjqfku7bkuI7lkKYKCQltb2RlbFZhbHVlOiB7CgkJCXR5cGU6IEJvb2xlYW4sCgkJCSdkZWZhdWx0JzogdHJ1ZQoJCX0sCgkJLy8g5LiK5Lyg5Zyw5Z2ACgkJdXJsOiB7CgkJCXR5cGU6IFN0cmluZywKCQkJJ2RlZmF1bHQnOiAnJwoJCX0sCgkJLy8g5YW25LuW6KaB5LiK5Lyg5paH5Lu26ZmE5bim55qE5pWw5o2u77yM5a+56LGh5qC85byPCgkJcGFyYW1zOiB7CgkJCXR5cGU6IE9iamVjdCwKCQkJJ2RlZmF1bHQnOiAoKT0+bnVsbAoJCX0sCgkJLy9BZGQgY3VzdG9tIGhlYWRlcnMKCQloZWFkZXJzOiB7CgkJCXR5cGU6IE9iamVjdCwKCQkJJ2RlZmF1bHQnOiAoKT0+bnVsbAoJCX0sCgkJLy8g5Ymq6KOB5Zu+54mH55qE5a69CgkJd2lkdGg6IHsKCQkJdHlwZTogTnVtYmVyLAoJCQlkZWZhdWx0OiAyMDAKCQl9LAoJCS8vIOWJquijgeWbvueJh+eahOmrmAoJCWhlaWdodDogewoJCQl0eXBlOiBOdW1iZXIsCgkJCWRlZmF1bHQ6IDIwMAoJCX0sCgkJLy8g5LiN5pi+56S65peL6L2s5Yqf6IO9CgkJbm9Sb3RhdGU6IHsKCQkJdHlwZTogQm9vbGVhbiwKCQkJZGVmYXVsdDogdHJ1ZQoJCX0sCgkJLy8g5LiN6aKE6KeI5ZyG5b2i5Zu+54mHCgkJbm9DaXJjbGU6IHsKCQkJdHlwZTogQm9vbGVhbiwKCQkJZGVmYXVsdDogZmFsc2UKCQl9LAoJCS8vIOS4jemihOiniOaWueW9ouWbvueJhwoJCW5vU3F1YXJlOiB7CgkJCXR5cGU6IEJvb2xlYW4sCgkJCWRlZmF1bHQ6IGZhbHNlCgkJfSwKCQkvLyDljZXmlofku7blpKflsI/pmZDliLYKCQltYXhTaXplOiB7CgkJCXR5cGU6IE51bWJlciwKCQkJJ2RlZmF1bHQnOiAxMDI0MAoJCX0sCgkJLy8g6K+t6KiA57G75Z6LCgkJbGFuZ1R5cGU6IHsKCQkJdHlwZTogU3RyaW5nLAoJCQknZGVmYXVsdCc6ICd6aCcKCQl9LAoJCS8vIOivreiogOWMhQoJCWxhbmdFeHQ6IHsKCQkJdHlwZTogT2JqZWN0LAoJCQknZGVmYXVsdCc6ICgpPT5udWxsCgkJfSwKCQkvLyDlm77niYfkuIrkvKDmoLzlvI8KCQlpbWdGb3JtYXQ6IHsKCQkJdHlwZTogU3RyaW5nLAoJCQknZGVmYXVsdCc6ICdwbmcnCgkJfSwKCQkvLyDlm77niYfog4zmma8ganBn5oOF5Ya15LiL55Sf5pWICgkJaW1nQmdjOiB7CgkJCXR5cGU6IFN0cmluZywKCQkJJ2RlZmF1bHQnOiAnI2ZmZicKCQl9LAoJCS8vIOaYr+WQpuaUr+aMgei3qOWfnwoJCXdpdGhDcmVkZW50aWFsczogewoJCQl0eXBlOiBCb29sZWFuLAoJCQknZGVmYXVsdCc6IGZhbHNlCgkJfSwKCQltZXRob2Q6IHsKCQkJdHlwZTogU3RyaW5nLAoJCQknZGVmYXVsdCc6ICdQT1NUJwoJCX0sCgkJaW5pdGlhbEltZ1VybDogewoJCQl0eXBlOiBTdHJpbmcsCgkJCSdkZWZhdWx0JzogJycKCSAgICB9LAoJICAgIGFsbG93SW1nRm9ybWF0OiB7CgkgICAgCXR5cGU6IEFycmF5LAoJICAgIAknZGVmYXVsdCc6ICgpPT5bCgkJICAgIAknZ2lmJywKCQkJJ2pwZycsCgkJCSdwbmcnCgkJCV0KCSAgICB9Cgl9LAoKCWRhdGEoKSB7CgkJbGV0IHRoYXQgPSB0aGlzLAoJCQl7CgkJCQlpbWdGb3JtYXQsCgkJCQlhbGxvd0ltZ0Zvcm1hdCwKCQkJCWxhbmdUeXBlLAoJCQkJbGFuZ0V4dCwKCQkJCXdpZHRoLAoJCQkJaGVpZ2h0CgkJCX0gPSB0aGF0LAoJCQlpc1N1cHBvcnRlZCA9IHRydWUsCgkJCXRlbXBJbWdGb3JtYXQgPSBhbGxvd0ltZ0Zvcm1hdC5pbmRleE9mKGltZ0Zvcm1hdCkgPT09IC0xID8gJ2pwZycgOiBpbWdGb3JtYXQsCgkJCWxhbmcgPSBsYW5ndWFnZVtsYW5nVHlwZV0gPyBsYW5ndWFnZVtsYW5nVHlwZV0gOiBsYW5ndWFnZVsnZW4nXSwKCQkJbWltZSA9IG1pbWVzW3RlbXBJbWdGb3JtYXRdOwoJCS8vIOinhOiMg+WbvueJh+agvOW8jwoJCS8vIHRoYXQuaW1nRm9ybWF0ID0gdGVtcEltZ0Zvcm1hdDsKCgkJaWYgKGxhbmdFeHQpIHsKCQkJT2JqZWN0LmFzc2lnbihsYW5nLCBsYW5nRXh0KTsKCQl9CgkJaWYgKHR5cGVvZiBGb3JtRGF0YSAhPSAnZnVuY3Rpb24nKSB7CgkJCWlzU3VwcG9ydGVkID0gZmFsc2U7CgkJfQoJCXJldHVybiB7CgkJCS8vIOWbvueJh+eahG1pbWUKCQkJbWltZSwKCgkJCS8vIOivreiogOWMhQoJCQlsYW5nLAoKCQkJLy8g5rWP6KeI5Zmo5piv5ZCm5pSv5oyB6K+l5o6n5Lu2CgkJCWlzU3VwcG9ydGVkLAoJCQkvLyDmtY/op4jlmajmmK/lkKbmlK/mjIHop6blsY/kuovku7YKCQkJaXNTdXBwb3J0VG91Y2g6IGRvY3VtZW50Lmhhc093blByb3BlcnR5KCJvbnRvdWNoc3RhcnQiKSwKCgkJCS8vIOatpemqpAoJCQlzdGVwOiAxLCAvLzHpgInmi6nmlofku7YgMuWJquijgSAz5LiK5LygCgoJCQkvLyDkuIrkvKDnirbmgIHlj4rov5vluqYKCQkJbG9hZGluZzogMCwgLy8w5pyq5byA5aeLIDHmraPlnKggMuaIkOWKnyAz6ZSZ6K+vCgkJCXByb2dyZXNzOiAwLAoKCQkJLy8g5piv5ZCm5pyJ6ZSZ6K+v5Y+K6ZSZ6K+v5L+h5oGvCgkJCWhhc0Vycm9yOiBmYWxzZSwKCQkJZXJyb3JNc2c6ICcnLAoKCQkJLy8g6ZyA5rGC5Zu+5a696auY5q+UCgkJCXJhdGlvOiB3aWR0aCAvIGhlaWdodCwKCgkJCS8vIOWOn+WbvuWcsOWdgOOAgeeUn+aIkOWbvueJh+WcsOWdgAoJCQlzb3VyY2VJbWc6IG51bGwsCgkJCXNvdXJjZUltZ1VybDogdGhpcy5pbml0aWFsSW1nVXJsLAoJCQljcmVhdGVJbWdVcmw6IHRoaXMuaW5pdGlhbEltZ1VybCwKCgkJCS8vIOWOn+WbvueJh+aLluWKqOS6i+S7tuWIneWni+WAvAoJCQlzb3VyY2VJbWdNb3VzZURvd246IHsKCQkJCW9uOiBmYWxzZSwKCQkJCW1YOiAwLCAvL+m8oOagh+aMieS4i+eahOWdkOaghwoJCQkJbVk6IDAsCgkJCQl4OiAwLCAvL3NjYWxl5Y6f5Zu+5Z2Q5qCHCgkJCQl5OiAwCgkJCX0sCgoJCQkvLyDnlJ/miJDlm77niYfpooTop4jnmoTlrrnlmajlpKflsI8KCQkJcHJldmlld0NvbnRhaW5lcjogewoJCQkJd2lkdGg6IDEwMCwKCQkJCWhlaWdodDogMTAwCgkJCX0sCgoJCQkvLyDljp/lm77lrrnlmajlrr3pq5gKCQkJc291cmNlSW1nQ29udGFpbmVyOiB7IC8vIHNpYwoJCQkJd2lkdGg6IDI0MCwKCQkJCWhlaWdodDogMTg0IC8vIOWmguaenOeUn+aIkOWbvuavlOS+i+S4juatpOS4gOiHtOS8muWHuueOsGJ1Z++8jOWFiOaUueaIkOeJueauiueahOagvOW8j+WQp++8jOWTiOWTiOWTiAoJCQl9LAoKCQkJLy8g5Y6f5Zu+5bGV56S65bGe5oCnCgkJCXNjYWxlOiB7CgkJCQl6b29tQWRkT246IGZhbHNlLCAvL+aMiemSrue8qeaUvuS6i+S7tuW8gOWQrwoJCQkJem9vbVN1Yk9uOiBmYWxzZSwgLy/mjInpkq7nvKnmlL7kuovku7blvIDlkK8KCQkJCXJhbmdlOiAxLCAvL+acgOWkpzEwMAoKCQkJCXg6IDAsCgkJCQl5OiAwLAoJCQkJd2lkdGg6IDAsCgkJCQloZWlnaHQ6IDAsCgkJCQltYXhXaWR0aDogMCwKCQkJCW1heEhlaWdodDogMCwKCQkJCW1pbldpZHRoOiAwLCAvL+acgOWuvQoJCQkJbWluSGVpZ2h0OiAwLAoJCQkJbmF0dXJhbFdpZHRoOiAwLCAvL+WOn+WuvQoJCQkJbmF0dXJhbEhlaWdodDogMAoJCQl9CgkJfQoJfSwKCgljb21wdXRlZDogewoJCS8vIOi/m+W6puadoeagt+W8jwoJCXByb2dyZXNzU3R5bGUoKSB7CgkJCWxldCB7CgkJCQlwcm9ncmVzcwoJCQl9ID0gdGhpczsKCQkJcmV0dXJuIHsKCQkJCXdpZHRoOiBwcm9ncmVzcyArICclJwoJCQl9CgkJfSwKCQkvLyDljp/lm77moLflvI8KCQlzb3VyY2VJbWdTdHlsZSgpIHsKCQkJbGV0IHsKCQkJCQlzY2FsZSwKCQkJCQlzb3VyY2VJbWdNYXNraW5nCgkJCQl9ID0gdGhpcywKCQkJCXRvcCA9IHNjYWxlLnkgKyBzb3VyY2VJbWdNYXNraW5nLnkgKyAncHgnLAoJCQkJbGVmdCA9IHNjYWxlLnggKyBzb3VyY2VJbWdNYXNraW5nLnggKyAncHgnOwoJCQlyZXR1cm4gewoJCQkJdG9wLAoJCQkJbGVmdCwKCQkJCXdpZHRoOiBzY2FsZS53aWR0aCArICdweCcsCgkJCQloZWlnaHQ6IHNjYWxlLmhlaWdodCArICdweCcsLy8g5YW85a65IE9wZXJhCgkJCX0KCQl9LAoJCS8vIOWOn+WbvuiSmeeJiOWxnuaApwoJCXNvdXJjZUltZ01hc2tpbmcoKSB7CgkJCWxldCB7CgkJCQkJd2lkdGgsCgkJCQkJaGVpZ2h0LAoJCQkJCXJhdGlvLAoJCQkJCXNvdXJjZUltZ0NvbnRhaW5lcgoJCQkJfSA9IHRoaXMsCgkJCQlzaWMgPSBzb3VyY2VJbWdDb250YWluZXIsCgkJCQlzaWNSYXRpbyA9IHNpYy53aWR0aCAvIHNpYy5oZWlnaHQsIC8vIOWOn+WbvuWuueWZqOWuvemrmOavlAoJCQkJeCA9IDAsCgkJCQl5ID0gMCwKCQkJCXcgPSBzaWMud2lkdGgsCgkJCQloID0gc2ljLmhlaWdodCwKCQkJCXNjYWxlID0gMTsKCQkJaWYgKHJhdGlvIDwgc2ljUmF0aW8pIHsKCQkJCXNjYWxlID0gc2ljLmhlaWdodCAvIGhlaWdodDsKCQkJCXcgPSBzaWMuaGVpZ2h0ICogcmF0aW87CgkJCQl4ID0gKHNpYy53aWR0aCAtIHcpIC8gMjsKCQkJfQoJCQlpZiAocmF0aW8gPiBzaWNSYXRpbykgewoJCQkJc2NhbGUgPSBzaWMud2lkdGggLyB3aWR0aDsKCQkJCWggPSBzaWMud2lkdGggLyByYXRpbzsKCQkJCXkgPSAoc2ljLmhlaWdodCAtIGgpIC8gMjsKCQkJfQoJCQlyZXR1cm4gewoJCQkJc2NhbGUsIC8vIOiSmeeJiOebuOWvuemcgOaxguWuvemrmOeahOe8qeaUvgoJCQkJeCwKCQkJCXksCgkJCQl3aWR0aDogdywKCQkJCWhlaWdodDogaAoJCQl9OwoJCX0sCgkJLy8g5Y6f5Zu+6YGu572p5qC35byPCgkJc291cmNlSW1nU2hhZGVTdHlsZSgpIHsKCQkJbGV0IHsKCQkJCQlzb3VyY2VJbWdNYXNraW5nLAoJCQkJCXNvdXJjZUltZ0NvbnRhaW5lcgoJCQkJfSA9IHRoaXMsCgkJCQlzaWMgPSBzb3VyY2VJbWdDb250YWluZXIsCgkJCQlzaW0gPSBzb3VyY2VJbWdNYXNraW5nLAoJCQkJdyA9IHNpbS53aWR0aCA9PSBzaWMud2lkdGggPyBzaW0ud2lkdGggOiAoc2ljLndpZHRoIC0gc2ltLndpZHRoKSAvIDIsCgkJCQloID0gc2ltLmhlaWdodCA9PSBzaWMuaGVpZ2h0ID8gc2ltLmhlaWdodCA6IChzaWMuaGVpZ2h0IC0gc2ltLmhlaWdodCkgLyAyOwoJCQlyZXR1cm4gewoJCQkJd2lkdGg6IHcgKyAncHgnLAoJCQkJaGVpZ2h0OiBoICsgJ3B4JwoJCQl9OwoJCX0sCgkJcHJldmlld1N0eWxlKCkgewoJCQlsZXQgewoJCQkJCXdpZHRoLAoJCQkJCWhlaWdodCwKCQkJCQlyYXRpbywKCQkJCQlwcmV2aWV3Q29udGFpbmVyCgkJCQl9ID0gdGhpcywKCQkJCXBjID0gcHJldmlld0NvbnRhaW5lciwKCQkJCXcgPSBwYy53aWR0aCwKCQkJCWggPSBwYy5oZWlnaHQsCgkJCQlwY1JhdGlvID0gdyAvIGg7CgkJCWlmIChyYXRpbyA8IHBjUmF0aW8pIHsKCQkJCXcgPSBwYy5oZWlnaHQgKiByYXRpbzsKCQkJfQoJCQlpZiAocmF0aW8gPiBwY1JhdGlvKSB7CgkJCQloID0gcGMud2lkdGggLyByYXRpbzsKCQkJfQoJCQlyZXR1cm4gewoJCQkJd2lkdGg6IHcgKyAncHgnLAoJCQkJaGVpZ2h0OiBoICsgJ3B4JwoJCQl9OwoJCX0KCX0sCgoJd2F0Y2g6IHsKCQltb2RlbFZhbHVlKG5ld1ZhbHVlKSB7CgkJCWlmIChuZXdWYWx1ZSAmJiB0aGlzLmxvYWRpbmcgIT0gMSkgewoJCQkJdGhpcy5yZXNldCgpOwoJCQl9CgkJfQoJfSwKCgljcmVhdGVkKCl7CgkJLy8g57uR5a6a5oyJ6ZSuZXNj6ZqQ6JeP5q2k5o+S5Lu25LqL5Lu2CgkJZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcigna2V5dXAnLCB0aGlzLmhhbmRsZUVzY0Nsb3NlICkKCX0sCgoJYmVmb3JlVW5tb3VudCgpewoJCWRvY3VtZW50LnJlbW92ZUV2ZW50TGlzdGVuZXIoJ2tleXVwJywgdGhpcy5oYW5kbGVFc2NDbG9zZSApCgl9LAoKCW1vdW50ZWQoKSB7CgkJaWYgKHRoaXMuc291cmNlSW1nVXJsKSB7CgkJCXRoaXMuc3RhcnRDcm9wKCk7CgkJfQoJfSwKCgltZXRob2RzOiB7CgkJaGFuZGxlRXNjQ2xvc2UoZSl7CgkJCWlmKHRoaXMubW9kZWxWYWx1ZSAmJiAoZS5rZXkgPT0gJ0VzY2FwZScgfHwgZS5rZXlDb2RlID09IDI3KSl7CgkJCQl0aGlzLm9mZigpOwoJCQl9CgkJfSwKCQkvLyDngrnlh7vms6LnurnmlYjmnpwKCQlyaXBwbGUoZSkgewoJCQllZmZlY3RSaXBwbGUoZSk7CgkJfSwKCQkvLyDlhbPpl63mjqfku7YKCQlvZmYoKSB7CgkJCXNldFRpbWVvdXQoKCk9PiB7CgkJCQl0aGlzLiRlbWl0KCd1cGRhdGU6bW9kZWxWYWx1ZScsIGZhbHNlKTsKCQkJCWlmKHRoaXMuc3RlcCA9PSAzICYmIHRoaXMubG9hZGluZyA9PSAyKXsKCQkJCQl0aGlzLnNldFN0ZXAoMSk7CgkJCQl9CgkJCX0sIDIwMCk7CgkJfSwKCQkvLyDorr7nva7mraXpqqQKCQlzZXRTdGVwKG5vKSB7CgkJCS8vIOW7tuaXtuaYr+S4uuS6huaYvuekuuWKqOeUu+aViOaenOWRou+8jOWTiOWTiOWTiAoJCQlzZXRUaW1lb3V0KCgpPT4gewoJCQkJdGhpcy5zdGVwID0gbm87CgkJCX0sIDIwMCk7CgkJfSwKCgkJLyog5Zu+54mH6YCJ5oup5Yy65Z+f5Ye95pWw57uR5a6aCgkJIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgkJcHJldmVudERlZmF1bHQoZSkgewoJCQllLnByZXZlbnREZWZhdWx0KCk7CgkJCXJldHVybiBmYWxzZTsKCQl9LAoJCWhhbmRsZUNsaWNrKGUpIHsKCQkJaWYgKHRoaXMubG9hZGluZyAhPT0gMSkgewoJCQkJaWYgKGUudGFyZ2V0ICE9PSB0aGlzLiRyZWZzLmZpbGVpbnB1dCkgewoJCQkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJCQlpZiAoZG9jdW1lbnQuYWN0aXZlRWxlbWVudCAhPT0gdGhpcy4kcmVmcykgewoJCQkJCQl0aGlzLiRyZWZzLmZpbGVpbnB1dC5jbGljaygpOwoJCQkJCX0KCQkJCX0KCQkJfQoJCX0sCgkJaGFuZGxlQ2hhbmdlKGUpIHsKCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCQlpZiAodGhpcy5sb2FkaW5nICE9PSAxKSB7CgkJCQlsZXQgZmlsZXMgPSBlLnRhcmdldC5maWxlcyB8fCBlLmRhdGFUcmFuc2Zlci5maWxlczsKCQkJCXRoaXMucmVzZXQoKTsKCQkJCWlmICh0aGlzLmNoZWNrRmlsZShmaWxlc1swXSkpIHsKCQkJCQl0aGlzLnNldFNvdXJjZUltZyhmaWxlc1swXSk7CgkJCQl9CgkJCX0KCQl9LAoJCS8qIC0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLSovCgoJCS8vIOajgOa1i+mAieaLqeeahOaWh+S7tuaYr+WQpuWQiOmAggoJCWNoZWNrRmlsZShmaWxlKSB7CgkJCWxldCB0aGF0ID0gdGhpcywKCQkJCXsKCQkJCQlsYW5nLAoJCQkJCW1heFNpemUKCQkJCX0gPSB0aGF0OwoJCQkvLyDku4XpmZDlm77niYcKCQkJaWYgKGZpbGUudHlwZS5pbmRleE9mKCdpbWFnZScpID09PSAtMSkgewoJCQkJdGhhdC5oYXNFcnJvciA9IHRydWU7CgkJCQl0aGF0LmVycm9yTXNnID0gbGFuZy5lcnJvci5vbmx5SW1nOwoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgoJCQkvLyDotoXlh7rlpKflsI8KCQkJaWYgKGZpbGUuc2l6ZSAvIDEwMjQgPiBtYXhTaXplKSB7CgkJCQl0aGF0Lmhhc0Vycm9yID0gdHJ1ZTsKCQkJCXRoYXQuZXJyb3JNc2cgPSBsYW5nLmVycm9yLm91dE9mU2l6ZSArIG1heFNpemUgKyAna2InOwoJCQkJcmV0dXJuIGZhbHNlOwoJCQl9CgkJCXJldHVybiB0cnVlOwoJCX0sCgkJLy8g6YeN572u5o6n5Lu2CgkJcmVzZXQoKSB7CgkJCWxldCB0aGF0ID0gdGhpczsKCQkJdGhhdC5sb2FkaW5nID0gMDsKCQkJdGhhdC5oYXNFcnJvciA9IGZhbHNlOwoJCQl0aGF0LmVycm9yTXNnID0gJyc7CgkJCXRoYXQucHJvZ3Jlc3MgPSAwOwoJCX0sCgkJLy8g6K6+572u5Zu+54mH5rqQCgkJc2V0U291cmNlSW1nKGZpbGUpIHsKCQkJdGhpcy4kZW1pdCgnc3JjLWZpbGUtc2V0JywgZmlsZS5uYW1lLCBmaWxlLnR5cGUsIGZpbGUuc2l6ZSk7CgkJCWxldCB0aGF0ID0gdGhpcywKCQkJCWZyID0gbmV3IEZpbGVSZWFkZXIoKTsKCQkJZnIub25sb2FkID0gZnVuY3Rpb24oZSkgewoJCQkJdGhhdC5zb3VyY2VJbWdVcmwgPSBmci5yZXN1bHQ7CgkJCQl0aGF0LnN0YXJ0Q3JvcCgpOwoJCQl9CgkJCWZyLnJlYWRBc0RhdGFVUkwoZmlsZSk7CgkJfSwKCQkvLyDliaroo4HliY3lh4blpIflt6XkvZwKCQlzdGFydENyb3AoKSB7CgkJCWxldCB0aGF0ID0gdGhpcywKCQkJCXsKCQkJCQl3aWR0aCwKCQkJCQloZWlnaHQsCgkJCQkJcmF0aW8sCgkJCQkJc2NhbGUsCgkJCQkJc291cmNlSW1nVXJsLAoJCQkJCXNvdXJjZUltZ01hc2tpbmcsCgkJCQkJbGFuZwoJCQkJfSA9IHRoYXQsCgkJCQlzaW0gPSBzb3VyY2VJbWdNYXNraW5nLAoJCQkJaW1nID0gbmV3IEltYWdlKCk7CgkJCWltZy5zcmMgPSBzb3VyY2VJbWdVcmw7CgkJCWltZy5vbmxvYWQgPSBmdW5jdGlvbigpIHsKCQkJCWxldCBuV2lkdGggPSBpbWcubmF0dXJhbFdpZHRoLAoJCQkJCW5IZWlnaHQgPSBpbWcubmF0dXJhbEhlaWdodCwKCQkJCQluUmF0aW8gPSBuV2lkdGggLyBuSGVpZ2h0LAoJCQkJCXcgPSBzaW0ud2lkdGgsCgkJCQkJaCA9IHNpbS5oZWlnaHQsCgkJCQkJeCA9IDAsCgkJCQkJeSA9IDA7CgkJCQkvLyDlm77niYflg4/ntKDkuI3ovr7moIcKCQkJCWlmIChuV2lkdGggPCB3aWR0aCB8fCBuSGVpZ2h0IDwgaGVpZ2h0KSB7CgkJCQkJdGhhdC5oYXNFcnJvciA9IHRydWU7CgkJCQkJdGhhdC5lcnJvck1zZyA9IGxhbmcuZXJyb3IubG93ZXN0UHggKyB3aWR0aCArICcqJyArIGhlaWdodDsKCQkJCQlyZXR1cm4gZmFsc2U7CgkJCQl9CgkJCQlpZiAocmF0aW8gPiBuUmF0aW8pIHsKCQkJCQloID0gdyAvIG5SYXRpbzsKCQkJCQl5ID0gKHNpbS5oZWlnaHQgLSBoKSAvIDI7CgkJCQl9CgkJCQlpZiAocmF0aW8gPCBuUmF0aW8pIHsKCQkJCQl3ID0gaCAqIG5SYXRpbzsKCQkJCQl4ID0gKHNpbS53aWR0aCAtIHcpIC8gMjsKCQkJCX0KCQkJCXNjYWxlLnJhbmdlID0gMDsKCQkJCXNjYWxlLnggPSB4OwoJCQkJc2NhbGUueSA9IHk7CgkJCQlzY2FsZS53aWR0aCA9IHc7CgkJCQlzY2FsZS5oZWlnaHQgPSBoOwoJCQkJc2NhbGUubWluV2lkdGggPSB3OwoJCQkJc2NhbGUubWluSGVpZ2h0ID0gaDsKCQkJCXNjYWxlLm1heFdpZHRoID0gbldpZHRoICogc2ltLnNjYWxlOwoJCQkJc2NhbGUubWF4SGVpZ2h0ID0gbkhlaWdodCAqIHNpbS5zY2FsZTsKCQkJCXNjYWxlLm5hdHVyYWxXaWR0aCA9IG5XaWR0aDsKCQkJCXNjYWxlLm5hdHVyYWxIZWlnaHQgPSBuSGVpZ2h0OwoJCQkJdGhhdC5zb3VyY2VJbWcgPSBpbWc7CgkJCQl0aGF0LmNyZWF0ZUltZygpOwoJCQkJdGhhdC5zZXRTdGVwKDIpOwoJCQl9OwoJCX0sCgkJLy8g6byg5qCH5oyJ5LiL5Zu+54mH5YeG5aSH56e75YqoCgkJaW1nU3RhcnRNb3ZlKGUpIHsKCQkJZS5wcmV2ZW50RGVmYXVsdCgpOwoJCQkvLyDmlK/mjIHop6bmkbjkuovku7bvvIzliJnpvKDmoIfkuovku7bml6DmlYgKCQkJaWYodGhpcy5pc1N1cHBvcnRUb3VjaCAmJiAhZS50YXJnZXRUb3VjaGVzKXsKCQkJCXJldHVybiBmYWxzZTsKCQkJfQoJCQlsZXQgZXQgPSBlLnRhcmdldFRvdWNoZXMgPyBlLnRhcmdldFRvdWNoZXNbMF0gOiBlLAoJCQkJewoJCQkJCXNvdXJjZUltZ01vdXNlRG93biwKCQkJCQlzY2FsZQoJCQkJfSA9IHRoaXMsCgkJCQlzaW1kID0gc291cmNlSW1nTW91c2VEb3duOwoJCQlzaW1kLm1YID0gZXQuc2NyZWVuWDsKCQkJc2ltZC5tWSA9IGV0LnNjcmVlblk7CgkJCXNpbWQueCA9IHNjYWxlLng7CgkJCXNpbWQueSA9IHNjYWxlLnk7CgkJCXNpbWQub24gPSB0cnVlOwoJCX0sCgkJLy8g6byg5qCH5oyJ5LiL54q25oCB5LiL56e75Yqo77yM5Zu+54mH56e75YqoCgkJaW1nTW92ZShlKSB7CgkJCWUucHJldmVudERlZmF1bHQoKTsKCQkJLy8g5pSv5oyB6Kem5pG45LqL5Lu277yM5YiZ6byg5qCH5LqL5Lu25peg5pWICgkJCWlmKHRoaXMuaXNTdXBwb3J0VG91Y2ggJiYgIWUudGFyZ2V0VG91Y2hlcyl7CgkJCQlyZXR1cm4gZmFsc2U7CgkJCX0KCQkJbGV0IGV0ID0gZS50YXJnZXRUb3VjaGVzID8gZS50YXJnZXRUb3VjaGVzWzBdIDogZSwKCQkJCXsKCQkJCQlzb3VyY2VJbWdNb3VzZURvd246IHsKCQkJCQkJb24sCgkJCQkJCW1YLAoJCQkJCQltWSwKCQkJCQkJeCwKCQkJCQkJeQoJCQkJCX0sCgkJCQkJc2NhbGUsCgkJCQkJc291cmNlSW1nTWFza2luZwoJCQkJfSA9IHRoaXMsCgkJCQlzaW0gPSBzb3VyY2VJbWdNYXNraW5nLAoJCQkJblggPSBldC5zY3JlZW5YLAoJCQkJblkgPSBldC5zY3JlZW5ZLAoJCQkJZFggPSBuWCAtIG1YLAoJCQkJZFkgPSBuWSAtIG1ZLAoJCQkJclggPSB4ICsgZFgsCgkJCQlyWSA9IHkgKyBkWTsKCQkJaWYgKCFvbikgcmV0dXJuOwoJCQlpZiAoclggPiAwKSB7CgkJCQlyWCA9IDA7CgkJCX0KCQkJaWYgKHJZID4gMCkgewoJCQkJclkgPSAwOwoJCQl9CgkJCWlmIChyWCA8IHNpbS53aWR0aCAtIHNjYWxlLndpZHRoKSB7CgkJCQlyWCA9IHNpbS53aWR0aCAtIHNjYWxlLndpZHRoOwoJCQl9CgkJCWlmIChyWSA8IHNpbS5oZWlnaHQgLSBzY2FsZS5oZWlnaHQpIHsKCQkJCXJZID0gc2ltLmhlaWdodCAtIHNjYWxlLmhlaWdodDsKCQkJfQoJCQlzY2FsZS54ID0gclg7CgkJCXNjYWxlLnkgPSByWTsKCQl9LAoJCS8vIOmhuuaXtumSiOaXi+i9rOWbvueJhwogICAgICAgIHJvdGF0ZUltZyhlKSB7CgkJCWxldCB7CgkJCQkJc291cmNlSW1nLAogICAgICAgICAgICAgICAgICAgIHNjYWxlOiB7CgkJCQkJCW5hdHVyYWxXaWR0aCwKCQkJCQkJbmF0dXJhbEhlaWdodCwKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9ID0gdGhpcywKCQkJCXdpZHRoID0gbmF0dXJhbEhlaWdodCwKCQkJCWhlaWdodCA9IG5hdHVyYWxXaWR0aCwKICAgICAgICAgICAgICAgIGNhbnZhcyA9IHRoaXMuJHJlZnMuY2FudmFzLAogICAgICAgICAgICAgICAgY3R4ID0gY2FudmFzLmdldENvbnRleHQoJzJkJyk7CgkJCWNhbnZhcy53aWR0aCA9IHdpZHRoOwogICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gaGVpZ2h0OwogICAgICAgICAgICBjdHguY2xlYXJSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpOwoKCQkJY3R4LmZpbGxTdHlsZSA9ICdyZ2JhKDAsMCwwLDApJzsKCQkJY3R4LmZpbGxSZWN0KDAsIDAsIHdpZHRoLCBoZWlnaHQpOwoKCQkJY3R4LnRyYW5zbGF0ZSh3aWR0aCwgMCk7CiAgICAgICAgICAgIGN0eC5yb3RhdGUoTWF0aC5QSSAqIDkwIC8gMTgwKTsKCiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2Uoc291cmNlSW1nLCAwLCAwLCBuYXR1cmFsV2lkdGgsIG5hdHVyYWxIZWlnaHQpOwogICAgICAgICAgICBsZXQgaW1nVXJsID0gY2FudmFzLnRvRGF0YVVSTChtaW1lc1sncG5nJ10pOwoKCQkJdGhpcy5zb3VyY2VJbWdVcmwgPSBpbWdVcmw7CgkJCXRoaXMuc3RhcnRDcm9wKCk7CiAgICAgICAgfSwKICAgICAgICBoYW5kbGVNb3VzZVdoZWVsKGUpewoJCQllID0gZSB8fCB3aW5kb3cuZXZlbnQ7CgkJCWxldCAJeyBzY2FsZSB9ID0gdGhpczsKCQkJaWYgKGUud2hlZWxEZWx0YSkgeyAgLy/liKTmlq3mtY/op4jlmahJRe+8jOiwt+atjOa7kei9ruS6i+S7tgoJCQkJaWYgKGUud2hlZWxEZWx0YSA+IDApIHsgLy/lvZPmu5Hova7lkJHkuIrmu5rliqjml7YKCQkJCQl0aGlzLnpvb21JbWcoc2NhbGUucmFuZ2UgPj0gMTAwID8gMTAwIDogKytzY2FsZS5yYW5nZSk7CgkJCQl9CgkJCQlpZiAoZS53aGVlbERlbHRhIDwgMCkgewoJCQkJCXRoaXMuem9vbUltZyhzY2FsZS5yYW5nZSA8PSAwID8gMCA6IC0tc2NhbGUucmFuZ2UpOwoJCQkJfQoJCQl9IGVsc2UgaWYgKGUuZGV0YWlsKSB7ICAvL0ZpcmVmb3jmu5Hova7kuovku7YKCQkJCWlmIChlLmRldGFpbCA+IDApIHsgLy/lvZPmu5Hova7lkJHkuIrmu5rliqjml7YKCQkJCQl0aGlzLnpvb21JbWcoc2NhbGUucmFuZ2UgPj0gMTAwID8gMTAwIDogKytzY2FsZS5yYW5nZSk7CgkJCQl9CgkJCQlpZiAoZS5kZXRhaWwgPCAwKSB7CgkJCQkJdGhpcy56b29tSW1nKHNjYWxlLnJhbmdlIDw9IDAgPyAwIDogLS1zY2FsZS5yYW5nZSk7CgkJCQl9CgkJCX0KICAgICAgICB9LAoJCS8vIOaMiemSruaMieS4i+W8gOWni+aUvuWkpwoJCXN0YXJ0Wm9vbUFkZChlKSB7CgkJCWxldCB0aGF0ID0gdGhpcywKCQkJCXsKCQkJCQlzY2FsZQoJCQkJfSA9IHRoYXQ7CgkJCXNjYWxlLnpvb21BZGRPbiA9IHRydWU7CgoJCQlmdW5jdGlvbiB6b29tKCkgewoJCQkJaWYgKHNjYWxlLnpvb21BZGRPbikgewoJCQkJCWxldCByYW5nZSA9IHNjYWxlLnJhbmdlID49IDEwMCA/IDEwMCA6ICsrc2NhbGUucmFuZ2U7CgkJCQkJdGhhdC56b29tSW1nKHJhbmdlKTsKCQkJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewoJCQkJCQl6b29tKCk7CgkJCQkJfSwgNjApOwoJCQkJfQoJCQl9CgkJCXpvb20oKTsKCQl9LAoJCS8vIOaMiemSruadvuW8gOaIluenu+W8gOWPlua2iOaUvuWkpwoJCWVuZFpvb21BZGQoZSkgewoJCQl0aGlzLnNjYWxlLnpvb21BZGRPbiA9IGZhbHNlOwoJCX0sCgkJLy8g5oyJ6ZKu5oyJ5LiL5byA5aeL57yp5bCPCgkJc3RhcnRab29tU3ViKGUpIHsKCQkJbGV0IHRoYXQgPSB0aGlzLAoJCQkJewoJCQkJCXNjYWxlCgkJCQl9ID0gdGhhdDsKCQkJc2NhbGUuem9vbVN1Yk9uID0gdHJ1ZTsKCgkJCWZ1bmN0aW9uIHpvb20oKSB7CgkJCQlpZiAoc2NhbGUuem9vbVN1Yk9uKSB7CgkJCQkJbGV0IHJhbmdlID0gc2NhbGUucmFuZ2UgPD0gMCA/IDAgOiAtLXNjYWxlLnJhbmdlOwoJCQkJCXRoYXQuem9vbUltZyhyYW5nZSk7CgkJCQkJc2V0VGltZW91dChmdW5jdGlvbigpIHsKCQkJCQkJem9vbSgpOwoJCQkJCX0sIDYwKTsKCQkJCX0KCQkJfQoJCQl6b29tKCk7CgkJfSwKCQkvLyDmjInpkq7mnb7lvIDmiJbnp7vlvIDlj5bmtojnvKnlsI8KCQllbmRab29tU3ViKGUpIHsKCQkJbGV0IHsKCQkJCXNjYWxlCgkJCX0gPSB0aGlzOwoJCQlzY2FsZS56b29tU3ViT24gPSBmYWxzZTsKCQl9LAoJCXpvb21DaGFuZ2UoZSkgewoJCQl0aGlzLnpvb21JbWcoZS50YXJnZXQudmFsdWUpOwoJCX0sCgkJLy8g57yp5pS+5Y6f5Zu+CgkJem9vbUltZyhuZXdSYW5nZSkgewoJCQlsZXQgdGhhdCA9IHRoaXMsCgkJCQl7CgkJCQkJc291cmNlSW1nTWFza2luZywKCQkJCQlzb3VyY2VJbWdNb3VzZURvd24sCgkJCQkJc2NhbGUKCQkJCX0gPSB0aGlzLAoJCQkJewoJCQkJCW1heFdpZHRoLAoJCQkJCW1heEhlaWdodCwKCQkJCQltaW5XaWR0aCwKCQkJCQltaW5IZWlnaHQsCgkJCQkJd2lkdGgsCgkJCQkJaGVpZ2h0LAoJCQkJCXgsCgkJCQkJeSwKCQkJCQlyYW5nZQoJCQkJfSA9IHNjYWxlLAoJCQkJc2ltID0gc291cmNlSW1nTWFza2luZywKCQkJCS8vIOiSmeeJiOWuvemrmAoJCQkJc1dpZHRoID0gc2ltLndpZHRoLAoJCQkJc0hlaWdodCA9IHNpbS5oZWlnaHQsCgkJCQkvLyDmlrDlrr3pq5gKCQkJCW5XaWR0aCA9IG1pbldpZHRoICsgKG1heFdpZHRoIC0gbWluV2lkdGgpICogbmV3UmFuZ2UgLyAxMDAsCgkJCQluSGVpZ2h0ID0gbWluSGVpZ2h0ICsgKG1heEhlaWdodCAtIG1pbkhlaWdodCkgKiBuZXdSYW5nZSAvIDEwMCwKCQkJCS8vIOaWsOWdkOagh++8iOagueaNruiSmeeJiOS4reW/g+eCuee8qeaUvu+8iQoJCQkJblggPSBzV2lkdGggLyAyIC0gKG5XaWR0aCAvIHdpZHRoKSAqIChzV2lkdGggLyAyIC0geCksCgkJCQluWSA9IHNIZWlnaHQgLyAyIC0gKG5IZWlnaHQgLyBoZWlnaHQpICogKHNIZWlnaHQgLyAyIC0geSk7CgoJCQkvLyDliKTmlq3mlrDlnZDmoIfmmK/lkKbotoXov4fokpnniYjpmZDliLYKCQkJaWYgKG5YID4gMCkgewoJCQkJblggPSAwOwoJCQl9CgkJCWlmIChuWSA+IDApIHsKCQkJCW5ZID0gMDsKCQkJfQoJCQlpZiAoblggPCBzV2lkdGggLSBuV2lkdGgpIHsKCQkJCW5YID0gc1dpZHRoIC0gbldpZHRoOwoJCQl9CgkJCWlmIChuWSA8IHNIZWlnaHQgLSBuSGVpZ2h0KSB7CgkJCQluWSA9IHNIZWlnaHQgLSBuSGVpZ2h0OwoJCQl9CgoJCQkvLyDotYvlgLzlpITnkIYKCQkJc2NhbGUueCA9IG5YOwoJCQlzY2FsZS55ID0gblk7CgkJCXNjYWxlLndpZHRoID0gbldpZHRoOwoJCQlzY2FsZS5oZWlnaHQgPSBuSGVpZ2h0OwoJCQlzY2FsZS5yYW5nZSA9IG5ld1JhbmdlOwoJCQlzZXRUaW1lb3V0KGZ1bmN0aW9uKCkgewoJCQkJaWYgKHNjYWxlLnJhbmdlID09IG5ld1JhbmdlKSB7CgkJCQkJdGhhdC5jcmVhdGVJbWcoKTsKCQkJCX0KCQkJfSwgMzAwKTsKCQl9LAoJCSAvLyDnlJ/miJDpnIDmsYLlm77niYcKICAgICAgICBjcmVhdGVJbWcoZSkgewogICAgICAgICAgICBsZXQgdGhhdCA9IHRoaXMsCiAgICAgICAgICAgICAgICB7CgkJCQkJaW1nRm9ybWF0LAoJCQkJCWltZ0JnYywKICAgICAgICAgICAgICAgICAgICBtaW1lLAogICAgICAgICAgICAgICAgICAgIHNvdXJjZUltZywKICAgICAgICAgICAgICAgICAgICBzY2FsZTogewogICAgICAgICAgICAgICAgICAgICAgICB4LAogICAgICAgICAgICAgICAgICAgICAgICB5LAogICAgICAgICAgICAgICAgICAgICAgICB3aWR0aCwKICAgICAgICAgICAgICAgICAgICAgICAgaGVpZ2h0LAogICAgICAgICAgICAgICAgICAgIH0sCiAgICAgICAgICAgICAgICAgICAgc291cmNlSW1nTWFza2luZzogewogICAgICAgICAgICAgICAgICAgICAgICBzY2FsZQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0gPSB0aGF0LAogICAgICAgICAgICAgICAgY2FudmFzID0gdGhhdC4kcmVmcy5jYW52YXMsCiAgICAgICAgICAgICAgICBjdHggPSBjYW52YXMuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgICAgICAgaWYgKGUpIHsKICAgICAgICAgICAgICAgIC8vIOWPlua2iOm8oOagh+aMieS4i+enu+WKqOeKtuaAgQogICAgICAgICAgICAgICAgdGhhdC5zb3VyY2VJbWdNb3VzZURvd24ub24gPSBmYWxzZTsKICAgICAgICAgICAgfQoJCQljYW52YXMud2lkdGggPSB0aGF0LndpZHRoOwogICAgICAgICAgICBjYW52YXMuaGVpZ2h0ID0gdGhhdC5oZWlnaHQ7CiAgICAgICAgICAgIGN0eC5jbGVhclJlY3QoMCwgMCwgdGhhdC53aWR0aCwgdGhhdC5oZWlnaHQpOwoKCQkJaWYoaW1nRm9ybWF0ID09ICdwbmcnKXsKCQkJCWN0eC5maWxsU3R5bGUgPSAncmdiYSgwLDAsMCwwKSc7CgkJCX0gZWxzZXsKCQkJCS8vIOWmguaenGpwZyDkuLrpgI/mmI7ljLrln5/orr7nva7og4zmma/vvIzpu5jorqTnmb3oibIKCQkJCWN0eC5maWxsU3R5bGUgPSBpbWdCZ2M7CgkJCX0KCQkJY3R4LmZpbGxSZWN0KDAsIDAsIHRoYXQud2lkdGgsIHRoYXQuaGVpZ2h0KTsKCiAgICAgICAgICAgIGN0eC5kcmF3SW1hZ2Uoc291cmNlSW1nLCB4IC8gc2NhbGUsIHkgLyBzY2FsZSwgd2lkdGggLyBzY2FsZSwgaGVpZ2h0IC8gc2NhbGUpOwogICAgICAgICAgICB0aGF0LmNyZWF0ZUltZ1VybCA9IGNhbnZhcy50b0RhdGFVUkwobWltZSk7CiAgICAgICAgfSwKCQlwcmVwYXJlVXBsb2FkKCl7CgkJCWxldCB7CgkJCQl1cmwsCgkJCQljcmVhdGVJbWdVcmwsCgkJCQlmaWVsZCwKCQkJCWtpCgkJCX0gPSB0aGlzOwoJCQl0aGlzLiRlbWl0KCdjcm9wLXN1Y2Nlc3MnLCBjcmVhdGVJbWdVcmwsIGZpZWxkLCBraSk7CgkJCWlmKHR5cGVvZiB1cmwgPT0gJ3N0cmluZycgJiYgdXJsKXsKCQkJCXRoaXMudXBsb2FkKCk7CgkJCX1lbHNlewoJCQkJdGhpcy5vZmYoKTsKCQkJfQoJCX0sCgkJLy8g5LiK5Lyg5Zu+54mHCgkJdXBsb2FkKCkgewoJCQlsZXQgdGhhdCA9IHRoaXMsCgkJCQl7CgkJCQkJbGFuZywKCQkJCQlpbWdGb3JtYXQsCgkJCQkJbWltZSwKCQkJCQl1cmwsCgkJCQkJcGFyYW1zLAoJCQkJCWhlYWRlcnMsCgkJCQkJZmllbGQsCgkJCQkJa2ksCgkJCQkJY3JlYXRlSW1nVXJsLAoJCQkJCXdpdGhDcmVkZW50aWFscywKCQkJCQltZXRob2QKCQkJCX0gPSB0aGlzLAoJCQkJZm1EYXRhID0gbmV3IEZvcm1EYXRhKCk7CgoJCQkvLyDmt7vliqDlhbbku5blj4LmlbAKCQkJaWYgKHR5cGVvZiBwYXJhbXMgPT0gJ29iamVjdCcgJiYgcGFyYW1zKSB7CgkJCQlPYmplY3Qua2V5cyhwYXJhbXMpLmZvckVhY2goKGspID0+IHsKCQkJCQlmbURhdGEuYXBwZW5kKGssIHBhcmFtc1trXSk7CgkJCQl9KQoJCQl9CgoJCQkvLyDlsIZmaWVsZOeahOa3u+WKoOaUvuWIsOihqOWNleWfn+eahOacgOWQju+8jOS7peaUr+aMgemYv+mHjOS6kU9TU+eahOihqOWNleS4iuS8oAoJCQlmbURhdGEuYXBwZW5kKGZpZWxkLCBkYXRhMmJsb2IoY3JlYXRlSW1nVXJsLCBtaW1lKSwgZmllbGQgKyAnLicgKyBpbWdGb3JtYXQpOwoKCgkJCS8vIOebkeWQrOi/m+W6puWbnuiwgwoJCQljb25zdCB1cGxvYWRQcm9ncmVzcyA9IGZ1bmN0aW9uKGV2ZW50KSB7CgkJCQlpZiAoZXZlbnQubGVuZ3RoQ29tcHV0YWJsZSkgewoJCQkJCXRoYXQucHJvZ3Jlc3MgPSAxMDAgKiBNYXRoLnJvdW5kKGV2ZW50LmxvYWRlZCkgLyBldmVudC50b3RhbDsKCQkJCX0KCQkJfTsKCgkJCS8vIOS4iuS8oOaWh+S7tgoJCQl0aGF0LnJlc2V0KCk7CgkJCXRoYXQubG9hZGluZyA9IDE7CgkJCXRoYXQuc2V0U3RlcCgzKTsKCQkJbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7CgkJCQlsZXQgY2xpZW50ID0gbmV3IFhNTEh0dHBSZXF1ZXN0KCk7CgkJCQljbGllbnQub3BlbihtZXRob2QsIHVybCwgdHJ1ZSk7CgkJCQljbGllbnQud2l0aENyZWRlbnRpYWxzID0gd2l0aENyZWRlbnRpYWxzOwoJCQkJY2xpZW50Lm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uKCkgewoJCQkJCWlmICh0aGlzLnJlYWR5U3RhdGUgIT09IDQpIHsKCQkJCQkJcmV0dXJuOwoJCQkJCX0KCQkJCQlpZiAodGhpcy5zdGF0dXMgPT09IDIwMCB8fCB0aGlzLnN0YXR1cyA9PT0gMjAxIHx8IHRoaXMuc3RhdXMgPT09MjAyICkgewoJCQkJCQlyZXNvbHZlKEpTT04ucGFyc2UodGhpcy5yZXNwb25zZVRleHQpKTsKCQkJCQl9IGVsc2UgewoJCQkJCQlyZWplY3QodGhpcy5zdGF0dXMpOwoJCQkJCX0KCQkJCX07CgkJCQljbGllbnQudXBsb2FkLmFkZEV2ZW50TGlzdGVuZXIoInByb2dyZXNzIiwgdXBsb2FkUHJvZ3Jlc3MsIGZhbHNlKTsgLy/nm5HlkKzov5vluqYKCQkJCS8vIOiuvue9rmhlYWRlcgoJCQkJaWYgKHR5cGVvZiBoZWFkZXJzID09ICdvYmplY3QnICYmIGhlYWRlcnMpIHsKCQkJCQlPYmplY3Qua2V5cyhoZWFkZXJzKS5mb3JFYWNoKChrKSA9PiB7CgkJCQkJCWNsaWVudC5zZXRSZXF1ZXN0SGVhZGVyKGssIGhlYWRlcnNba10pOwoJCQkJCX0pCgkJCQl9CgkJCQljbGllbnQuc2VuZChmbURhdGEpOwoJCQl9KS50aGVuKAoJCQkJLy8g5LiK5Lyg5oiQ5YqfCgkJCQlmdW5jdGlvbihyZXNEYXRhKSB7CgkJCQkJaWYgKHRoYXQubW9kZWxWYWx1ZSkgewoJCQkJCQl0aGF0LmxvYWRpbmcgPSAyOwoJCQkJCQl0aGF0LiRlbWl0KCdjcm9wLXVwbG9hZC1zdWNjZXNzJywgcmVzRGF0YSwgZmllbGQsIGtpKTsKCQkJCQl9CgkJCQl9LAoJCQkJLy8g5LiK5Lyg5aSx6LSlCgkJCQlmdW5jdGlvbihzdHMpIHsKCQkJCQlpZiAodGhhdC5tb2RlbFZhbHVlKSB7CgkJCQkJCXRoYXQubG9hZGluZyA9IDM7CgkJCQkJCXRoYXQuaGFzRXJyb3IgPSB0cnVlOwoJCQkJCQl0aGF0LmVycm9yTXNnID0gbGFuZy5mYWlsOwoJCQkJCQl0aGF0LiRlbWl0KCdjcm9wLXVwbG9hZC1mYWlsJywgc3RzLCBmaWVsZCwga2kpOwoJCQkJCX0KCQkJCX0KCQkJKTsKCQl9Cgl9LAp9Cgo="},{"version":3,"sources":["upload-3.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwGA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"upload-3.vue","sourceRoot":"node_modules/vue-image-crop-upload","sourcesContent":["<template>\n<div class=\"vue-image-crop-upload\" v-show=\"modelValue\">\n\t<div class=\"vicp-wrap\">\n\t\t<div class=\"vicp-close\" @click=\"off\">\n\t\t\t<i class=\"vicp-icon4\"></i>\n\t\t</div>\n\n\t\t<div class=\"vicp-step1\" v-show=\"step == 1\">\n\t\t\t<div class=\"vicp-drop-area\" @dragleave=\"preventDefault\" @dragover=\"preventDefault\" @dragenter=\"preventDefault\" @click=\"handleClick\" @drop=\"handleChange\">\n\t\t\t\t<i class=\"vicp-icon1\" v-show=\"loading != 1\">\n\t\t\t\t<i class=\"vicp-icon1-arrow\"></i>\n\t\t\t\t<i class=\"vicp-icon1-body\"></i>\n\t\t\t\t<i class=\"vicp-icon1-bottom\"></i>\n\t\t\t\t</i>\n\t\t\t\t<span class=\"vicp-hint\" v-show=\"loading !== 1\">{{ lang.hint }}</span>\n\t\t\t\t<span class=\"vicp-no-supported-hint\" v-show=\"!isSupported\">{{ lang.noSupported }}</span>\n\t\t\t\t<input type=\"file\" accept=\"image/*\" v-show=\"false\" v-if=\"step == 1\" @change=\"handleChange\" ref=\"fileinput\">\n\t\t\t</div>\n\t\t\t<div class=\"vicp-error\" v-show=\"hasError\">\n\t\t\t\t<i class=\"vicp-icon2\"></i> {{ errorMsg }}\n\t\t\t</div>\n\t\t\t<div class=\"vicp-operate\">\n\t\t\t\t<a @click=\"off\" @mousedown=\"ripple\">{{ lang.btn.off }}</a>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"vicp-step2\" v-if=\"step == 2\">\n\t\t\t<div class=\"vicp-crop\">\n\t\t\t\t<div class=\"vicp-crop-left\" v-show=\"true\">\n\t\t\t\t\t<div class=\"vicp-img-container\" @wheel.prevent=\"handleMouseWheel\">\n\t\t\t\t\t\t<img :src=\"sourceImgUrl\" :style=\"sourceImgStyle\" class=\"vicp-img\" draggable=\"false\"\n\t\t\t\t\t\t\t@drag=\"preventDefault\"\n\t\t\t\t\t\t\t@dragstart=\"preventDefault\"\n\t\t\t\t\t\t\t@dragend=\"preventDefault\"\n\t\t\t\t\t\t\t@dragleave=\"preventDefault\"\n\t\t\t\t\t\t\t@dragover=\"preventDefault\"\n\t\t\t\t\t\t\t@dragenter=\"preventDefault\"\n\t\t\t\t\t\t\t@drop=\"preventDefault\"\n\t\t\t\t\t\t\t@touchstart=\"imgStartMove\"\n\t\t\t\t\t\t\t@touchmove=\"imgMove\"\n\t\t\t\t\t\t\t@touchend=\"createImg\"\n\t\t\t\t\t\t\t@touchcancel=\"createImg\"\n\t\t\t\t\t\t\t@mousedown=\"imgStartMove\"\n\t\t\t\t\t\t\t@mousemove=\"imgMove\"\n\t\t\t\t\t\t\t@mouseup=\"createImg\"\n\t\t\t\t\t\t\t@mouseout=\"createImg\"\n\t\t\t\t\t\t\tref=\"img\">\n\t\t\t\t\t\t<div class=\"vicp-img-shade vicp-img-shade-1\" :style=\"sourceImgShadeStyle\"></div>\n\t\t\t\t\t\t<div class=\"vicp-img-shade vicp-img-shade-2\" :style=\"sourceImgShadeStyle\"></div>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"vicp-range\">\n\t\t\t\t\t\t<input type=\"range\" v-model=\"scale.range\" step=\"1\" min=\"0\" max=\"100\" @mousemove=\"zoomChange\">\n\t\t\t\t\t\t<i @mousedown=\"startZoomSub\" @mouseout=\"endZoomSub\" @mouseup=\"endZoomSub\" class=\"vicp-icon5\"></i>\n\t\t\t\t\t\t<i @mousedown=\"startZoomAdd\" @mouseout=\"endZoomAdd\" @mouseup=\"endZoomAdd\" class=\"vicp-icon6\"></i>\n\t\t\t\t\t</div>\n\n\t\t\t\t\t<div class=\"vicp-rotate\" v-if=\"!noRotate\">\n                        <i @click=\"rotateImg\">↻</i>\n                    </div>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"vicp-crop-right\" v-show=\"true\">\n\t\t\t\t\t<div class=\"vicp-preview\">\n\t\t\t\t\t\t<div class=\"vicp-preview-item\" v-if=\"!noSquare\">\n\t\t\t\t\t\t\t<img :src=\"createImgUrl\" :style=\"previewStyle\">\n\t\t\t\t\t\t\t<span>{{ lang.preview }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div class=\"vicp-preview-item vicp-preview-item-circle\" v-if=\"!noCircle\">\n\t\t\t\t\t\t\t<img :src=\"createImgUrl\" :style=\"previewStyle\">\n\t\t\t\t\t\t\t<span>{{ lang.preview }}</span>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"vicp-operate\">\n\t\t\t\t<a @click=\"setStep(1)\" @mousedown=\"ripple\">{{ lang.btn.back }}</a>\n\t\t\t\t<a class=\"vicp-operate-btn\" @click=\"prepareUpload\" @mousedown=\"ripple\">{{ lang.btn.save }}</a>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class=\"vicp-step3\" v-if=\"step == 3\">\n\t\t\t<div class=\"vicp-upload\">\n\t\t\t\t<span class=\"vicp-loading\" v-show=\"loading === 1\">{{ lang.loading }}</span>\n\t\t\t\t<div class=\"vicp-progress-wrap\">\n\t\t\t\t\t<span class=\"vicp-progress\" v-show=\"loading === 1\" :style=\"progressStyle\"></span>\n\t\t\t\t</div>\n\t\t\t\t<div class=\"vicp-error\" v-show=\"hasError\">\n\t\t\t\t\t<i class=\"vicp-icon2\"></i> {{ errorMsg }}\n\t\t\t\t</div>\n\t\t\t\t<div class=\"vicp-success\" v-show=\"loading === 2\">\n\t\t\t\t\t<i class=\"vicp-icon3\"></i> {{ lang.success }}\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class=\"vicp-operate\">\n\t\t\t\t<a @click=\"setStep(2)\" @mousedown=\"ripple\">{{ lang.btn.back }}</a>\n\t\t\t\t<a @click=\"off\" @mousedown=\"ripple\">{{ lang.btn.close }}</a>\n\t\t\t</div>\n\t\t</div>\n\t\t<canvas v-show=\"false\" :width=\"width\" :height=\"height\" ref=\"canvas\"></canvas>\n\t</div>\n</div>\n</template>\n\n<script>\n'use strict';\nimport language from './utils/language.js';\nimport mimes from './utils/mimes.js';\nimport data2blob from './utils/data2blob.js';\nimport effectRipple from './utils/effectRipple.js';\n\nexport default {\n\tprops: {\n\t\t// 域，上传文件name，触发事件会带上（如果一个页面多个图片上传控件，可以做区分\n\t\tfield: {\n\t\t\ttype: String,\n\t\t\t'default': 'avatar'\n\t\t},\n\t\t// 原名key，类似于id，触发事件会带上（如果一个页面多个图片上传控件，可以做区分\n\t\tki: {\n\t\t\ttype: String,\n\t\t\t'default': '0'\n\t\t},\n\t\t// 显示该控件与否\n\t\tmodelValue: {\n\t\t\ttype: Boolean,\n\t\t\t'default': true\n\t\t},\n\t\t// 上传地址\n\t\turl: {\n\t\t\ttype: String,\n\t\t\t'default': ''\n\t\t},\n\t\t// 其他要上传文件附带的数据，对象格式\n\t\tparams: {\n\t\t\ttype: Object,\n\t\t\t'default': ()=>null\n\t\t},\n\t\t//Add custom headers\n\t\theaders: {\n\t\t\ttype: Object,\n\t\t\t'default': ()=>null\n\t\t},\n\t\t// 剪裁图片的宽\n\t\twidth: {\n\t\t\ttype: Number,\n\t\t\tdefault: 200\n\t\t},\n\t\t// 剪裁图片的高\n\t\theight: {\n\t\t\ttype: Number,\n\t\t\tdefault: 200\n\t\t},\n\t\t// 不显示旋转功能\n\t\tnoRotate: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: true\n\t\t},\n\t\t// 不预览圆形图片\n\t\tnoCircle: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\t// 不预览方形图片\n\t\tnoSquare: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false\n\t\t},\n\t\t// 单文件大小限制\n\t\tmaxSize: {\n\t\t\ttype: Number,\n\t\t\t'default': 10240\n\t\t},\n\t\t// 语言类型\n\t\tlangType: {\n\t\t\ttype: String,\n\t\t\t'default': 'zh'\n\t\t},\n\t\t// 语言包\n\t\tlangExt: {\n\t\t\ttype: Object,\n\t\t\t'default': ()=>null\n\t\t},\n\t\t// 图片上传格式\n\t\timgFormat: {\n\t\t\ttype: String,\n\t\t\t'default': 'png'\n\t\t},\n\t\t// 图片背景 jpg情况下生效\n\t\timgBgc: {\n\t\t\ttype: String,\n\t\t\t'default': '#fff'\n\t\t},\n\t\t// 是否支持跨域\n\t\twithCredentials: {\n\t\t\ttype: Boolean,\n\t\t\t'default': false\n\t\t},\n\t\tmethod: {\n\t\t\ttype: String,\n\t\t\t'default': 'POST'\n\t\t},\n\t\tinitialImgUrl: {\n\t\t\ttype: String,\n\t\t\t'default': ''\n\t    },\n\t    allowImgFormat: {\n\t    \ttype: Array,\n\t    \t'default': ()=>[\n\t\t    \t'gif',\n\t\t\t'jpg',\n\t\t\t'png'\n\t\t\t]\n\t    }\n\t},\n\n\tdata() {\n\t\tlet that = this,\n\t\t\t{\n\t\t\t\timgFormat,\n\t\t\t\tallowImgFormat,\n\t\t\t\tlangType,\n\t\t\t\tlangExt,\n\t\t\t\twidth,\n\t\t\t\theight\n\t\t\t} = that,\n\t\t\tisSupported = true,\n\t\t\ttempImgFormat = allowImgFormat.indexOf(imgFormat) === -1 ? 'jpg' : imgFormat,\n\t\t\tlang = language[langType] ? language[langType] : language['en'],\n\t\t\tmime = mimes[tempImgFormat];\n\t\t// 规范图片格式\n\t\t// that.imgFormat = tempImgFormat;\n\n\t\tif (langExt) {\n\t\t\tObject.assign(lang, langExt);\n\t\t}\n\t\tif (typeof FormData != 'function') {\n\t\t\tisSupported = false;\n\t\t}\n\t\treturn {\n\t\t\t// 图片的mime\n\t\t\tmime,\n\n\t\t\t// 语言包\n\t\t\tlang,\n\n\t\t\t// 浏览器是否支持该控件\n\t\t\tisSupported,\n\t\t\t// 浏览器是否支持触屏事件\n\t\t\tisSupportTouch: document.hasOwnProperty(\"ontouchstart\"),\n\n\t\t\t// 步骤\n\t\t\tstep: 1, //1选择文件 2剪裁 3上传\n\n\t\t\t// 上传状态及进度\n\t\t\tloading: 0, //0未开始 1正在 2成功 3错误\n\t\t\tprogress: 0,\n\n\t\t\t// 是否有错误及错误信息\n\t\t\thasError: false,\n\t\t\terrorMsg: '',\n\n\t\t\t// 需求图宽高比\n\t\t\tratio: width / height,\n\n\t\t\t// 原图地址、生成图片地址\n\t\t\tsourceImg: null,\n\t\t\tsourceImgUrl: this.initialImgUrl,\n\t\t\tcreateImgUrl: this.initialImgUrl,\n\n\t\t\t// 原图片拖动事件初始值\n\t\t\tsourceImgMouseDown: {\n\t\t\t\ton: false,\n\t\t\t\tmX: 0, //鼠标按下的坐标\n\t\t\t\tmY: 0,\n\t\t\t\tx: 0, //scale原图坐标\n\t\t\t\ty: 0\n\t\t\t},\n\n\t\t\t// 生成图片预览的容器大小\n\t\t\tpreviewContainer: {\n\t\t\t\twidth: 100,\n\t\t\t\theight: 100\n\t\t\t},\n\n\t\t\t// 原图容器宽高\n\t\t\tsourceImgContainer: { // sic\n\t\t\t\twidth: 240,\n\t\t\t\theight: 184 // 如果生成图比例与此一致会出现bug，先改成特殊的格式吧，哈哈哈\n\t\t\t},\n\n\t\t\t// 原图展示属性\n\t\t\tscale: {\n\t\t\t\tzoomAddOn: false, //按钮缩放事件开启\n\t\t\t\tzoomSubOn: false, //按钮缩放事件开启\n\t\t\t\trange: 1, //最大100\n\n\t\t\t\tx: 0,\n\t\t\t\ty: 0,\n\t\t\t\twidth: 0,\n\t\t\t\theight: 0,\n\t\t\t\tmaxWidth: 0,\n\t\t\t\tmaxHeight: 0,\n\t\t\t\tminWidth: 0, //最宽\n\t\t\t\tminHeight: 0,\n\t\t\t\tnaturalWidth: 0, //原宽\n\t\t\t\tnaturalHeight: 0\n\t\t\t}\n\t\t}\n\t},\n\n\tcomputed: {\n\t\t// 进度条样式\n\t\tprogressStyle() {\n\t\t\tlet {\n\t\t\t\tprogress\n\t\t\t} = this;\n\t\t\treturn {\n\t\t\t\twidth: progress + '%'\n\t\t\t}\n\t\t},\n\t\t// 原图样式\n\t\tsourceImgStyle() {\n\t\t\tlet {\n\t\t\t\t\tscale,\n\t\t\t\t\tsourceImgMasking\n\t\t\t\t} = this,\n\t\t\t\ttop = scale.y + sourceImgMasking.y + 'px',\n\t\t\t\tleft = scale.x + sourceImgMasking.x + 'px';\n\t\t\treturn {\n\t\t\t\ttop,\n\t\t\t\tleft,\n\t\t\t\twidth: scale.width + 'px',\n\t\t\t\theight: scale.height + 'px',// 兼容 Opera\n\t\t\t}\n\t\t},\n\t\t// 原图蒙版属性\n\t\tsourceImgMasking() {\n\t\t\tlet {\n\t\t\t\t\twidth,\n\t\t\t\t\theight,\n\t\t\t\t\tratio,\n\t\t\t\t\tsourceImgContainer\n\t\t\t\t} = this,\n\t\t\t\tsic = sourceImgContainer,\n\t\t\t\tsicRatio = sic.width / sic.height, // 原图容器宽高比\n\t\t\t\tx = 0,\n\t\t\t\ty = 0,\n\t\t\t\tw = sic.width,\n\t\t\t\th = sic.height,\n\t\t\t\tscale = 1;\n\t\t\tif (ratio < sicRatio) {\n\t\t\t\tscale = sic.height / height;\n\t\t\t\tw = sic.height * ratio;\n\t\t\t\tx = (sic.width - w) / 2;\n\t\t\t}\n\t\t\tif (ratio > sicRatio) {\n\t\t\t\tscale = sic.width / width;\n\t\t\t\th = sic.width / ratio;\n\t\t\t\ty = (sic.height - h) / 2;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\tscale, // 蒙版相对需求宽高的缩放\n\t\t\t\tx,\n\t\t\t\ty,\n\t\t\t\twidth: w,\n\t\t\t\theight: h\n\t\t\t};\n\t\t},\n\t\t// 原图遮罩样式\n\t\tsourceImgShadeStyle() {\n\t\t\tlet {\n\t\t\t\t\tsourceImgMasking,\n\t\t\t\t\tsourceImgContainer\n\t\t\t\t} = this,\n\t\t\t\tsic = sourceImgContainer,\n\t\t\t\tsim = sourceImgMasking,\n\t\t\t\tw = sim.width == sic.width ? sim.width : (sic.width - sim.width) / 2,\n\t\t\t\th = sim.height == sic.height ? sim.height : (sic.height - sim.height) / 2;\n\t\t\treturn {\n\t\t\t\twidth: w + 'px',\n\t\t\t\theight: h + 'px'\n\t\t\t};\n\t\t},\n\t\tpreviewStyle() {\n\t\t\tlet {\n\t\t\t\t\twidth,\n\t\t\t\t\theight,\n\t\t\t\t\tratio,\n\t\t\t\t\tpreviewContainer\n\t\t\t\t} = this,\n\t\t\t\tpc = previewContainer,\n\t\t\t\tw = pc.width,\n\t\t\t\th = pc.height,\n\t\t\t\tpcRatio = w / h;\n\t\t\tif (ratio < pcRatio) {\n\t\t\t\tw = pc.height * ratio;\n\t\t\t}\n\t\t\tif (ratio > pcRatio) {\n\t\t\t\th = pc.width / ratio;\n\t\t\t}\n\t\t\treturn {\n\t\t\t\twidth: w + 'px',\n\t\t\t\theight: h + 'px'\n\t\t\t};\n\t\t}\n\t},\n\n\twatch: {\n\t\tmodelValue(newValue) {\n\t\t\tif (newValue && this.loading != 1) {\n\t\t\t\tthis.reset();\n\t\t\t}\n\t\t}\n\t},\n\n\tcreated(){\n\t\t// 绑定按键esc隐藏此插件事件\n\t\tdocument.addEventListener('keyup', this.handleEscClose )\n\t},\n\n\tbeforeUnmount(){\n\t\tdocument.removeEventListener('keyup', this.handleEscClose )\n\t},\n\n\tmounted() {\n\t\tif (this.sourceImgUrl) {\n\t\t\tthis.startCrop();\n\t\t}\n\t},\n\n\tmethods: {\n\t\thandleEscClose(e){\n\t\t\tif(this.modelValue && (e.key == 'Escape' || e.keyCode == 27)){\n\t\t\t\tthis.off();\n\t\t\t}\n\t\t},\n\t\t// 点击波纹效果\n\t\tripple(e) {\n\t\t\teffectRipple(e);\n\t\t},\n\t\t// 关闭控件\n\t\toff() {\n\t\t\tsetTimeout(()=> {\n\t\t\t\tthis.$emit('update:modelValue', false);\n\t\t\t\tif(this.step == 3 && this.loading == 2){\n\t\t\t\t\tthis.setStep(1);\n\t\t\t\t}\n\t\t\t}, 200);\n\t\t},\n\t\t// 设置步骤\n\t\tsetStep(no) {\n\t\t\t// 延时是为了显示动画效果呢，哈哈哈\n\t\t\tsetTimeout(()=> {\n\t\t\t\tthis.step = no;\n\t\t\t}, 200);\n\t\t},\n\n\t\t/* 图片选择区域函数绑定\n\t\t ---------------------------------------------------------------*/\n\t\tpreventDefault(e) {\n\t\t\te.preventDefault();\n\t\t\treturn false;\n\t\t},\n\t\thandleClick(e) {\n\t\t\tif (this.loading !== 1) {\n\t\t\t\tif (e.target !== this.$refs.fileinput) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tif (document.activeElement !== this.$refs) {\n\t\t\t\t\t\tthis.$refs.fileinput.click();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\thandleChange(e) {\n\t\t\te.preventDefault();\n\t\t\tif (this.loading !== 1) {\n\t\t\t\tlet files = e.target.files || e.dataTransfer.files;\n\t\t\t\tthis.reset();\n\t\t\t\tif (this.checkFile(files[0])) {\n\t\t\t\t\tthis.setSourceImg(files[0]);\n\t\t\t\t}\n\t\t\t}\n\t\t},\n\t\t/* ---------------------------------------------------------------*/\n\n\t\t// 检测选择的文件是否合适\n\t\tcheckFile(file) {\n\t\t\tlet that = this,\n\t\t\t\t{\n\t\t\t\t\tlang,\n\t\t\t\t\tmaxSize\n\t\t\t\t} = that;\n\t\t\t// 仅限图片\n\t\t\tif (file.type.indexOf('image') === -1) {\n\t\t\t\tthat.hasError = true;\n\t\t\t\tthat.errorMsg = lang.error.onlyImg;\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// 超出大小\n\t\t\tif (file.size / 1024 > maxSize) {\n\t\t\t\tthat.hasError = true;\n\t\t\t\tthat.errorMsg = lang.error.outOfSize + maxSize + 'kb';\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\treturn true;\n\t\t},\n\t\t// 重置控件\n\t\treset() {\n\t\t\tlet that = this;\n\t\t\tthat.loading = 0;\n\t\t\tthat.hasError = false;\n\t\t\tthat.errorMsg = '';\n\t\t\tthat.progress = 0;\n\t\t},\n\t\t// 设置图片源\n\t\tsetSourceImg(file) {\n\t\t\tthis.$emit('src-file-set', file.name, file.type, file.size);\n\t\t\tlet that = this,\n\t\t\t\tfr = new FileReader();\n\t\t\tfr.onload = function(e) {\n\t\t\t\tthat.sourceImgUrl = fr.result;\n\t\t\t\tthat.startCrop();\n\t\t\t}\n\t\t\tfr.readAsDataURL(file);\n\t\t},\n\t\t// 剪裁前准备工作\n\t\tstartCrop() {\n\t\t\tlet that = this,\n\t\t\t\t{\n\t\t\t\t\twidth,\n\t\t\t\t\theight,\n\t\t\t\t\tratio,\n\t\t\t\t\tscale,\n\t\t\t\t\tsourceImgUrl,\n\t\t\t\t\tsourceImgMasking,\n\t\t\t\t\tlang\n\t\t\t\t} = that,\n\t\t\t\tsim = sourceImgMasking,\n\t\t\t\timg = new Image();\n\t\t\timg.src = sourceImgUrl;\n\t\t\timg.onload = function() {\n\t\t\t\tlet nWidth = img.naturalWidth,\n\t\t\t\t\tnHeight = img.naturalHeight,\n\t\t\t\t\tnRatio = nWidth / nHeight,\n\t\t\t\t\tw = sim.width,\n\t\t\t\t\th = sim.height,\n\t\t\t\t\tx = 0,\n\t\t\t\t\ty = 0;\n\t\t\t\t// 图片像素不达标\n\t\t\t\tif (nWidth < width || nHeight < height) {\n\t\t\t\t\tthat.hasError = true;\n\t\t\t\t\tthat.errorMsg = lang.error.lowestPx + width + '*' + height;\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t\tif (ratio > nRatio) {\n\t\t\t\t\th = w / nRatio;\n\t\t\t\t\ty = (sim.height - h) / 2;\n\t\t\t\t}\n\t\t\t\tif (ratio < nRatio) {\n\t\t\t\t\tw = h * nRatio;\n\t\t\t\t\tx = (sim.width - w) / 2;\n\t\t\t\t}\n\t\t\t\tscale.range = 0;\n\t\t\t\tscale.x = x;\n\t\t\t\tscale.y = y;\n\t\t\t\tscale.width = w;\n\t\t\t\tscale.height = h;\n\t\t\t\tscale.minWidth = w;\n\t\t\t\tscale.minHeight = h;\n\t\t\t\tscale.maxWidth = nWidth * sim.scale;\n\t\t\t\tscale.maxHeight = nHeight * sim.scale;\n\t\t\t\tscale.naturalWidth = nWidth;\n\t\t\t\tscale.naturalHeight = nHeight;\n\t\t\t\tthat.sourceImg = img;\n\t\t\t\tthat.createImg();\n\t\t\t\tthat.setStep(2);\n\t\t\t};\n\t\t},\n\t\t// 鼠标按下图片准备移动\n\t\timgStartMove(e) {\n\t\t\te.preventDefault();\n\t\t\t// 支持触摸事件，则鼠标事件无效\n\t\t\tif(this.isSupportTouch && !e.targetTouches){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet et = e.targetTouches ? e.targetTouches[0] : e,\n\t\t\t\t{\n\t\t\t\t\tsourceImgMouseDown,\n\t\t\t\t\tscale\n\t\t\t\t} = this,\n\t\t\t\tsimd = sourceImgMouseDown;\n\t\t\tsimd.mX = et.screenX;\n\t\t\tsimd.mY = et.screenY;\n\t\t\tsimd.x = scale.x;\n\t\t\tsimd.y = scale.y;\n\t\t\tsimd.on = true;\n\t\t},\n\t\t// 鼠标按下状态下移动，图片移动\n\t\timgMove(e) {\n\t\t\te.preventDefault();\n\t\t\t// 支持触摸事件，则鼠标事件无效\n\t\t\tif(this.isSupportTouch && !e.targetTouches){\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tlet et = e.targetTouches ? e.targetTouches[0] : e,\n\t\t\t\t{\n\t\t\t\t\tsourceImgMouseDown: {\n\t\t\t\t\t\ton,\n\t\t\t\t\t\tmX,\n\t\t\t\t\t\tmY,\n\t\t\t\t\t\tx,\n\t\t\t\t\t\ty\n\t\t\t\t\t},\n\t\t\t\t\tscale,\n\t\t\t\t\tsourceImgMasking\n\t\t\t\t} = this,\n\t\t\t\tsim = sourceImgMasking,\n\t\t\t\tnX = et.screenX,\n\t\t\t\tnY = et.screenY,\n\t\t\t\tdX = nX - mX,\n\t\t\t\tdY = nY - mY,\n\t\t\t\trX = x + dX,\n\t\t\t\trY = y + dY;\n\t\t\tif (!on) return;\n\t\t\tif (rX > 0) {\n\t\t\t\trX = 0;\n\t\t\t}\n\t\t\tif (rY > 0) {\n\t\t\t\trY = 0;\n\t\t\t}\n\t\t\tif (rX < sim.width - scale.width) {\n\t\t\t\trX = sim.width - scale.width;\n\t\t\t}\n\t\t\tif (rY < sim.height - scale.height) {\n\t\t\t\trY = sim.height - scale.height;\n\t\t\t}\n\t\t\tscale.x = rX;\n\t\t\tscale.y = rY;\n\t\t},\n\t\t// 顺时针旋转图片\n        rotateImg(e) {\n\t\t\tlet {\n\t\t\t\t\tsourceImg,\n                    scale: {\n\t\t\t\t\t\tnaturalWidth,\n\t\t\t\t\t\tnaturalHeight,\n                    }\n                } = this,\n\t\t\t\twidth = naturalHeight,\n\t\t\t\theight = naturalWidth,\n                canvas = this.$refs.canvas,\n                ctx = canvas.getContext('2d');\n\t\t\tcanvas.width = width;\n            canvas.height = height;\n            ctx.clearRect(0, 0, width, height);\n\n\t\t\tctx.fillStyle = 'rgba(0,0,0,0)';\n\t\t\tctx.fillRect(0, 0, width, height);\n\n\t\t\tctx.translate(width, 0);\n            ctx.rotate(Math.PI * 90 / 180);\n\n            ctx.drawImage(sourceImg, 0, 0, naturalWidth, naturalHeight);\n            let imgUrl = canvas.toDataURL(mimes['png']);\n\n\t\t\tthis.sourceImgUrl = imgUrl;\n\t\t\tthis.startCrop();\n        },\n        handleMouseWheel(e){\n\t\t\te = e || window.event;\n\t\t\tlet \t{ scale } = this;\n\t\t\tif (e.wheelDelta) {  //判断浏览器IE，谷歌滑轮事件\n\t\t\t\tif (e.wheelDelta > 0) { //当滑轮向上滚动时\n\t\t\t\t\tthis.zoomImg(scale.range >= 100 ? 100 : ++scale.range);\n\t\t\t\t}\n\t\t\t\tif (e.wheelDelta < 0) {\n\t\t\t\t\tthis.zoomImg(scale.range <= 0 ? 0 : --scale.range);\n\t\t\t\t}\n\t\t\t} else if (e.detail) {  //Firefox滑轮事件\n\t\t\t\tif (e.detail > 0) { //当滑轮向上滚动时\n\t\t\t\t\tthis.zoomImg(scale.range >= 100 ? 100 : ++scale.range);\n\t\t\t\t}\n\t\t\t\tif (e.detail < 0) {\n\t\t\t\t\tthis.zoomImg(scale.range <= 0 ? 0 : --scale.range);\n\t\t\t\t}\n\t\t\t}\n        },\n\t\t// 按钮按下开始放大\n\t\tstartZoomAdd(e) {\n\t\t\tlet that = this,\n\t\t\t\t{\n\t\t\t\t\tscale\n\t\t\t\t} = that;\n\t\t\tscale.zoomAddOn = true;\n\n\t\t\tfunction zoom() {\n\t\t\t\tif (scale.zoomAddOn) {\n\t\t\t\t\tlet range = scale.range >= 100 ? 100 : ++scale.range;\n\t\t\t\t\tthat.zoomImg(range);\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tzoom();\n\t\t\t\t\t}, 60);\n\t\t\t\t}\n\t\t\t}\n\t\t\tzoom();\n\t\t},\n\t\t// 按钮松开或移开取消放大\n\t\tendZoomAdd(e) {\n\t\t\tthis.scale.zoomAddOn = false;\n\t\t},\n\t\t// 按钮按下开始缩小\n\t\tstartZoomSub(e) {\n\t\t\tlet that = this,\n\t\t\t\t{\n\t\t\t\t\tscale\n\t\t\t\t} = that;\n\t\t\tscale.zoomSubOn = true;\n\n\t\t\tfunction zoom() {\n\t\t\t\tif (scale.zoomSubOn) {\n\t\t\t\t\tlet range = scale.range <= 0 ? 0 : --scale.range;\n\t\t\t\t\tthat.zoomImg(range);\n\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\tzoom();\n\t\t\t\t\t}, 60);\n\t\t\t\t}\n\t\t\t}\n\t\t\tzoom();\n\t\t},\n\t\t// 按钮松开或移开取消缩小\n\t\tendZoomSub(e) {\n\t\t\tlet {\n\t\t\t\tscale\n\t\t\t} = this;\n\t\t\tscale.zoomSubOn = false;\n\t\t},\n\t\tzoomChange(e) {\n\t\t\tthis.zoomImg(e.target.value);\n\t\t},\n\t\t// 缩放原图\n\t\tzoomImg(newRange) {\n\t\t\tlet that = this,\n\t\t\t\t{\n\t\t\t\t\tsourceImgMasking,\n\t\t\t\t\tsourceImgMouseDown,\n\t\t\t\t\tscale\n\t\t\t\t} = this,\n\t\t\t\t{\n\t\t\t\t\tmaxWidth,\n\t\t\t\t\tmaxHeight,\n\t\t\t\t\tminWidth,\n\t\t\t\t\tminHeight,\n\t\t\t\t\twidth,\n\t\t\t\t\theight,\n\t\t\t\t\tx,\n\t\t\t\t\ty,\n\t\t\t\t\trange\n\t\t\t\t} = scale,\n\t\t\t\tsim = sourceImgMasking,\n\t\t\t\t// 蒙版宽高\n\t\t\t\tsWidth = sim.width,\n\t\t\t\tsHeight = sim.height,\n\t\t\t\t// 新宽高\n\t\t\t\tnWidth = minWidth + (maxWidth - minWidth) * newRange / 100,\n\t\t\t\tnHeight = minHeight + (maxHeight - minHeight) * newRange / 100,\n\t\t\t\t// 新坐标（根据蒙版中心点缩放）\n\t\t\t\tnX = sWidth / 2 - (nWidth / width) * (sWidth / 2 - x),\n\t\t\t\tnY = sHeight / 2 - (nHeight / height) * (sHeight / 2 - y);\n\n\t\t\t// 判断新坐标是否超过蒙版限制\n\t\t\tif (nX > 0) {\n\t\t\t\tnX = 0;\n\t\t\t}\n\t\t\tif (nY > 0) {\n\t\t\t\tnY = 0;\n\t\t\t}\n\t\t\tif (nX < sWidth - nWidth) {\n\t\t\t\tnX = sWidth - nWidth;\n\t\t\t}\n\t\t\tif (nY < sHeight - nHeight) {\n\t\t\t\tnY = sHeight - nHeight;\n\t\t\t}\n\n\t\t\t// 赋值处理\n\t\t\tscale.x = nX;\n\t\t\tscale.y = nY;\n\t\t\tscale.width = nWidth;\n\t\t\tscale.height = nHeight;\n\t\t\tscale.range = newRange;\n\t\t\tsetTimeout(function() {\n\t\t\t\tif (scale.range == newRange) {\n\t\t\t\t\tthat.createImg();\n\t\t\t\t}\n\t\t\t}, 300);\n\t\t},\n\t\t // 生成需求图片\n        createImg(e) {\n            let that = this,\n                {\n\t\t\t\t\timgFormat,\n\t\t\t\t\timgBgc,\n                    mime,\n                    sourceImg,\n                    scale: {\n                        x,\n                        y,\n                        width,\n                        height,\n                    },\n                    sourceImgMasking: {\n                        scale\n                    }\n                } = that,\n                canvas = that.$refs.canvas,\n                ctx = canvas.getContext('2d');\n            if (e) {\n                // 取消鼠标按下移动状态\n                that.sourceImgMouseDown.on = false;\n            }\n\t\t\tcanvas.width = that.width;\n            canvas.height = that.height;\n            ctx.clearRect(0, 0, that.width, that.height);\n\n\t\t\tif(imgFormat == 'png'){\n\t\t\t\tctx.fillStyle = 'rgba(0,0,0,0)';\n\t\t\t} else{\n\t\t\t\t// 如果jpg 为透明区域设置背景，默认白色\n\t\t\t\tctx.fillStyle = imgBgc;\n\t\t\t}\n\t\t\tctx.fillRect(0, 0, that.width, that.height);\n\n            ctx.drawImage(sourceImg, x / scale, y / scale, width / scale, height / scale);\n            that.createImgUrl = canvas.toDataURL(mime);\n        },\n\t\tprepareUpload(){\n\t\t\tlet {\n\t\t\t\turl,\n\t\t\t\tcreateImgUrl,\n\t\t\t\tfield,\n\t\t\t\tki\n\t\t\t} = this;\n\t\t\tthis.$emit('crop-success', createImgUrl, field, ki);\n\t\t\tif(typeof url == 'string' && url){\n\t\t\t\tthis.upload();\n\t\t\t}else{\n\t\t\t\tthis.off();\n\t\t\t}\n\t\t},\n\t\t// 上传图片\n\t\tupload() {\n\t\t\tlet that = this,\n\t\t\t\t{\n\t\t\t\t\tlang,\n\t\t\t\t\timgFormat,\n\t\t\t\t\tmime,\n\t\t\t\t\turl,\n\t\t\t\t\tparams,\n\t\t\t\t\theaders,\n\t\t\t\t\tfield,\n\t\t\t\t\tki,\n\t\t\t\t\tcreateImgUrl,\n\t\t\t\t\twithCredentials,\n\t\t\t\t\tmethod\n\t\t\t\t} = this,\n\t\t\t\tfmData = new FormData();\n\n\t\t\t// 添加其他参数\n\t\t\tif (typeof params == 'object' && params) {\n\t\t\t\tObject.keys(params).forEach((k) => {\n\t\t\t\t\tfmData.append(k, params[k]);\n\t\t\t\t})\n\t\t\t}\n\n\t\t\t// 将field的添加放到表单域的最后，以支持阿里云OSS的表单上传\n\t\t\tfmData.append(field, data2blob(createImgUrl, mime), field + '.' + imgFormat);\n\n\n\t\t\t// 监听进度回调\n\t\t\tconst uploadProgress = function(event) {\n\t\t\t\tif (event.lengthComputable) {\n\t\t\t\t\tthat.progress = 100 * Math.round(event.loaded) / event.total;\n\t\t\t\t}\n\t\t\t};\n\n\t\t\t// 上传文件\n\t\t\tthat.reset();\n\t\t\tthat.loading = 1;\n\t\t\tthat.setStep(3);\n\t\t\tnew Promise(function(resolve, reject) {\n\t\t\t\tlet client = new XMLHttpRequest();\n\t\t\t\tclient.open(method, url, true);\n\t\t\t\tclient.withCredentials = withCredentials;\n\t\t\t\tclient.onreadystatechange = function() {\n\t\t\t\t\tif (this.readyState !== 4) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tif (this.status === 200 || this.status === 201 || this.staus ===202 ) {\n\t\t\t\t\t\tresolve(JSON.parse(this.responseText));\n\t\t\t\t\t} else {\n\t\t\t\t\t\treject(this.status);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tclient.upload.addEventListener(\"progress\", uploadProgress, false); //监听进度\n\t\t\t\t// 设置header\n\t\t\t\tif (typeof headers == 'object' && headers) {\n\t\t\t\t\tObject.keys(headers).forEach((k) => {\n\t\t\t\t\t\tclient.setRequestHeader(k, headers[k]);\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t\tclient.send(fmData);\n\t\t\t}).then(\n\t\t\t\t// 上传成功\n\t\t\t\tfunction(resData) {\n\t\t\t\t\tif (that.modelValue) {\n\t\t\t\t\t\tthat.loading = 2;\n\t\t\t\t\t\tthat.$emit('crop-upload-success', resData, field, ki);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\t// 上传失败\n\t\t\t\tfunction(sts) {\n\t\t\t\t\tif (that.modelValue) {\n\t\t\t\t\t\tthat.loading = 3;\n\t\t\t\t\t\tthat.hasError = true;\n\t\t\t\t\t\tthat.errorMsg = lang.fail;\n\t\t\t\t\t\tthat.$emit('crop-upload-fail', sts, field, ki);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t);\n\t\t}\n\t},\n}\n\n</script>\n\n<!--\n<style lang='sass' src=\"./scss/upload.scss\">\n</style> -->\n\n<style>\n@import url('upload.css');\n</style>\n"]}]}