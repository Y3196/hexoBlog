{"remainingRequest":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\babel-loader\\lib\\index.js!E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\src\\views\\user\\User.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\src\\views\\user\\User.vue","mtime":1723782109341},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\sourceCode\\Backend\\blog-master\\blog-vue\\blog\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZm9yLWVhY2giOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIuZG9tLWNvbGxlY3Rpb25zLmZvci1lYWNoIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KaW1wb3J0IEF2YXRhckNyb3BwZXIgZnJvbSAidnVlLWF2YXRhci1jcm9wcGVyIjsKZXhwb3J0IGRlZmF1bHQgewogIGNvbXBvbmVudHM6IHsKICAgIEF2YXRhckNyb3BwZXI6IEF2YXRhckNyb3BwZXIKICB9LAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB1c2VySW5mbzogewogICAgICAgIG5pY2tuYW1lOiB0aGlzLiRzdG9yZS5zdGF0ZS5uaWNrbmFtZSwKICAgICAgICBpbnRybzogdGhpcy4kc3RvcmUuc3RhdGUuaW50cm8sCiAgICAgICAgd2ViU2l0ZTogdGhpcy4kc3RvcmUuc3RhdGUud2ViU2l0ZSwKICAgICAgICBsb2dpblR5cGU6IHRoaXMuJHN0b3JlLnN0YXRlLmxvZ2luVHlwZQogICAgICB9CiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgaGFuZGxlQ2xpY2s6IGZ1bmN0aW9uIGhhbmRsZUNsaWNrKCkgewogICAgICBjb25zb2xlLmxvZygiQXZhdGFyIGJ1dHRvbiBjbGlja2VkIik7CiAgICB9LAogICAgaGFuZGxlRXJyb3I6IGZ1bmN0aW9uIGhhbmRsZUVycm9yKGVycm9yKSB7CiAgICAgIGNvbnNvbGUuZXJyb3IoJ0F2YXRhciBjcm9wcGVyIGVycm9yOicsIGVycm9yKTsKCiAgICAgIGlmIChlcnJvci5yZXNwb25zZSkgewogICAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZSBkYXRhOicsIGVycm9yLnJlc3BvbnNlLmRhdGEpOwogICAgICAgIGNvbnNvbGUubG9nKCdSZXNwb25zZSBzdGF0dXM6JywgZXJyb3IucmVzcG9uc2Uuc3RhdHVzKTsKICAgICAgICBjb25zb2xlLmxvZygnUmVzcG9uc2UgaGVhZGVyczonLCBlcnJvci5yZXNwb25zZS5oZWFkZXJzKTsKICAgICAgfSBlbHNlIGlmIChlcnJvci5yZXF1ZXN0KSB7CiAgICAgICAgY29uc29sZS5sb2coJ1JlcXVlc3QgbWFkZSBidXQgbm8gcmVzcG9uc2UgcmVjZWl2ZWQ6JywgZXJyb3IucmVxdWVzdCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5sb2coJ0Vycm9yIGR1cmluZyBzZXR1cCBvZiByZXF1ZXN0OicsIGVycm9yLm1lc3NhZ2UpOwogICAgICB9CiAgICB9LAogICAgYmVmb3JlVXBsb2FkOiBmdW5jdGlvbiBiZWZvcmVVcGxvYWQoZmlsZSwgeGhyKSB7CiAgICAgIGNvbnNvbGUubG9nKCJiZWZvcmVVcGxvYWQgY2FsbGVkIHdpdGggZmlsZToiLCBmaWxlKTsKICAgICAgdmFyIHRva2VuID0gdGhpcy4kc3RvcmUuc3RhdGUudG9rZW4gfHwgbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3Rva2VuJyk7CgogICAgICBpZiAodG9rZW4pIHsKICAgICAgICB4aHIuc2V0UmVxdWVzdEhlYWRlcignQXV0aG9yaXphdGlvbicsICJCZWFyZXIgIi5jb25jYXQodG9rZW4pKTsKICAgICAgICBjb25zb2xlLmxvZygiQXV0aG9yaXphdGlvbiBoZWFkZXIgc2V0OiIsICJCZWFyZXIgIi5jb25jYXQodG9rZW4pKTsKICAgICAgICByZXR1cm4gdHJ1ZTsgLy8g5YWB6K645LiK5LygCiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29uc29sZS5lcnJvcignTm8gdG9rZW4gYXZhaWxhYmxlJyk7CiAgICAgICAgcmV0dXJuIGZhbHNlOyAvLyDpmLvmraLkuIrkvKAKICAgICAgfQogICAgfSwKICAgIHVwZGF0YVVzZXJJbmZvOiBmdW5jdGlvbiB1cGRhdGFVc2VySW5mbygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHZhciB0b2tlbiA9IHRoaXMuJHN0b3JlLnN0YXRlLnRva2VuIHx8IGxvY2FsU3RvcmFnZS5nZXRJdGVtKCd0b2tlbicpOwogICAgICB0aGlzLmF4aW9zLnB1dCgiL2FwaS91c2Vycy9pbmZvIiwgdGhpcy51c2VySW5mbywgewogICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICdBdXRob3JpemF0aW9uJzogIkJlYXJlciAiLmNvbmNhdCh0b2tlbikKICAgICAgICB9CiAgICAgIH0pLnRoZW4oZnVuY3Rpb24gKF9yZWYpIHsKICAgICAgICB2YXIgZGF0YSA9IF9yZWYuZGF0YTsKCiAgICAgICAgaWYgKGRhdGEuZmxhZykgewogICAgICAgICAgX3RoaXMuJHN0b3JlLmNvbW1pdCgidXBkYXRlVXNlckluZm8iLCBfdGhpcy51c2VySW5mbyk7CgogICAgICAgICAgX3RoaXMuJHRvYXN0KHsKICAgICAgICAgICAgdHlwZTogInN1Y2Nlc3MiLAogICAgICAgICAgICBtZXNzYWdlOiAi5L+u5pS55oiQ5YqfIgogICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIF90aGlzLiR0b2FzdCh7CiAgICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICAgIG1lc3NhZ2U6IGRhdGEubWVzc2FnZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICB1cGxvYWRBdmF0YXI6IGZ1bmN0aW9uIHVwbG9hZEF2YXRhcihkYXRhKSB7CiAgICAgIGNvbnNvbGUubG9nKCd1cGxvYWRBdmF0YXIgY2FsbGVkJywgZGF0YSk7IC8vIOehruS/nei/meS4quaWueazleS5n+iiq+iwg+eUqAoKICAgICAgaWYgKGRhdGEuZmxhZykgewogICAgICAgIHRoaXMuJHN0b3JlLmNvbW1pdCgidXBkYXRlQXZhdGFyIiwgZGF0YS5kYXRhKTsKICAgICAgICB0aGlzLiR0b2FzdCh7CiAgICAgICAgICB0eXBlOiAic3VjY2VzcyIsCiAgICAgICAgICBtZXNzYWdlOiAi5LiK5Lyg5oiQ5YqfIgogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMuJHRvYXN0KHsKICAgICAgICAgIHR5cGU6ICJlcnJvciIsCiAgICAgICAgICBtZXNzYWdlOiBkYXRhLm1lc3NhZ2UKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIG9wZW5FbWFpbE1vZGVsOiBmdW5jdGlvbiBvcGVuRW1haWxNb2RlbCgpIHsKICAgICAgdGhpcy4kc3RvcmUuc3RhdGUuZW1haWxGbGFnID0gdHJ1ZTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBlbWFpbDogZnVuY3Rpb24gZW1haWwoKSB7CiAgICAgIHJldHVybiB0aGlzLiRzdG9yZS5zdGF0ZS5lbWFpbDsKICAgIH0sCiAgICBsb2dpblR5cGU6IGZ1bmN0aW9uIGxvZ2luVHlwZSgpIHsKICAgICAgcmV0dXJuIHRoaXMuJHN0b3JlLnN0YXRlLmxvZ2luVHlwZTsKICAgIH0sCiAgICBjb3ZlcjogZnVuY3Rpb24gY292ZXIoKSB7CiAgICAgIHZhciBjb3ZlciA9ICIiOwogICAgICB0aGlzLiRzdG9yZS5zdGF0ZS5ibG9nSW5mby5wYWdlTGlzdC5mb3JFYWNoKGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgaWYgKGl0ZW0ucGFnZUxhYmVsID09ICJ1c2VyIikgewogICAgICAgICAgY292ZXIgPSBpdGVtLnBhZ2VDb3ZlcjsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gImJhY2tncm91bmQ6IHVybCgiICsgY292ZXIgKyAiKSBjZW50ZXIgY2VudGVyIC8gY292ZXIgbm8tcmVwZWF0IjsKICAgIH0KICB9Cn07"},{"version":3,"sources":["User.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div>\n    <div class=\"banner\" :style=\"cover\">\n      <h1 class=\"banner-title\">个人中心</h1>\n    </div>\n    <v-card class=\"blog-container\">\n      <div>\n        <span class=\"info-title\">基本信息</span>\n      </div>\n      <v-row class=\"info-wrapper\">\n        <v-col md=\"3\" cols=\"12\">\n          <button id=\"pick-avatar\">\n            <v-avatar size=\"140\">\n              <img :src=\"this.$store.state.avatar\" />\n            </v-avatar>\n          </button>\n          <avatar-cropper\n              @uploaded=\"uploadAvatar\"\n              trigger=\"#pick-avatar\"\n              upload-url=\"/api/users/avatar\"\n              :before-upload=\"beforeUpload\"\n          @error=\"handleError\"\n          />\n\n        </v-col>\n        <v-col md=\"7\" cols=\"12\">\n          <v-text-field\n            v-model=\"userInfo.nickname\"\n            label=\"昵称\"\n            placeholder=\"请输入您的昵称\"\n          />\n          <v-text-field\n            v-model=\"userInfo.webSite\"\n            class=\"mt-7\"\n            label=\"个人网站\"\n            placeholder=\"http://你的网址\"\n          />\n          <v-text-field\n            v-model=\"userInfo.intro\"\n            class=\"mt-7\"\n            label=\"简介\"\n            placeholder=\"介绍下自己吧\"\n          />\n          <div v-if=\"loginType != 0\" class=\"mt-7 binding\">\n            <v-text-field\n              disabled\n              v-model=\"email\"\n              label=\"邮箱号\"\n              placeholder=\"请绑定邮箱\"\n            />\n            <v-btn v-if=\"email\" text small @click=\"openEmailModel\">\n              修改绑定\n            </v-btn>\n            <v-btn v-else text small @click=\"openEmailModel\">\n              绑定邮箱\n            </v-btn>\n          </div>\n          <v-btn @click=\"updataUserInfo\" outlined class=\"mt-5\">修改</v-btn>\n        </v-col>\n      </v-row>\n    </v-card>\n  </div>\n</template>\n<script>\nimport AvatarCropper from \"vue-avatar-cropper\";\nexport default {\n  components: { AvatarCropper },\n  data: function() {\n    return {\n      userInfo: {\n        nickname: this.$store.state.nickname,\n        intro: this.$store.state.intro,\n        webSite: this.$store.state.webSite,\n        loginType: this.$store.state.loginType\n      }\n    };\n  },\n  methods: {\n    handleClick(){\n      console.log(\"Avatar button clicked\")\n    },\n    handleError(error) {\n      console.error('Avatar cropper error:', error);\n      if (error.response) {\n        console.log('Response data:', error.response.data);\n        console.log('Response status:', error.response.status);\n        console.log('Response headers:', error.response.headers);\n      } else if (error.request) {\n        console.log('Request made but no response received:', error.request);\n      } else {\n        console.log('Error during setup of request:', error.message);\n      }\n    }\n\n,\n    beforeUpload(file, xhr) {\n      console.log(\"beforeUpload called with file:\", file);\n      const token = this.$store.state.token || localStorage.getItem('token');\n      if (token) {\n        xhr.setRequestHeader('Authorization', `Bearer ${token}`);\n        console.log(\"Authorization header set:\", `Bearer ${token}`);\n        return true; // 允许上传\n      } else {\n        console.error('No token available');\n        return false; // 阻止上传\n      }\n    }\n\n,\n    updataUserInfo() {\n      const token = this.$store.state.token || localStorage.getItem('token');\n      this.axios.put(\"/api/users/info\", this.userInfo,{  headers: {\n          'Authorization': `Bearer ${token}`\n        },}).then(({ data }) => {\n        if (data.flag) {\n          this.$store.commit(\"updateUserInfo\", this.userInfo);\n          this.$toast({ type: \"success\", message: \"修改成功\" });\n        } else {\n          this.$toast({ type: \"error\", message: data.message });\n        }\n      });\n    },\n    uploadAvatar(data) {\n      console.log('uploadAvatar called', data); // 确保这个方法也被调用\n      if (data.flag) {\n        this.$store.commit(\"updateAvatar\", data.data);\n        this.$toast({ type: \"success\", message: \"上传成功\" });\n      } else {\n        this.$toast({ type: \"error\", message: data.message });\n      }\n    },\n    openEmailModel() {\n      this.$store.state.emailFlag = true;\n    }\n  },\n  computed: {\n    email() {\n      return this.$store.state.email;\n    },\n    loginType() {\n      return this.$store.state.loginType;\n    },\n    cover() {\n      var cover = \"\";\n      this.$store.state.blogInfo.pageList.forEach(item => {\n        if (item.pageLabel == \"user\") {\n          cover = item.pageCover;\n        }\n      });\n      return \"background: url(\" + cover + \") center center / cover no-repeat\";\n    }\n  }\n};\n</script>\n\n<style scoped>\n.info-title {\n  font-size: 1.25rem;\n  font-weight: bold;\n}\n.info-wrapper {\n  margin-top: 1rem;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n}\n#pick-avatar {\n  outline: none;\n}\n.binding {\n  display: flex;\n  align-items: center;\n}\n</style>\n"],"sourceRoot":"src/views/user"}]}